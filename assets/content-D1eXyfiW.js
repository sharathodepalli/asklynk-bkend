var Gs=Object.defineProperty;var Rn=e=>{throw TypeError(e)};var Hs=(e,n,t)=>n in e?Gs(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var K=(e,n,t)=>Hs(e,typeof n!="symbol"?n+"":n,t),en=(e,n,t)=>n.has(e)||Rn("Cannot "+t);var c=(e,n,t)=>(en(e,n,"read from private field"),t?t.call(e):n.get(e)),U=(e,n,t)=>n.has(e)?Rn("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,t),$=(e,n,t,s)=>(en(e,n,"write to private field"),s?s.call(e,t):n.set(e,t),t),N=(e,n,t)=>(en(e,n,"access private method"),t);var Rt=(e,n,t,s)=>({set _(r){$(e,n,r,t)},get _(){return c(e,n,s)}});import{g as Ys,r as D,a as rs,b as is,c as oe,d as ft,s as M,e as jn,j as d,u as ke,f as Zs,R as Ks}from"./auth-tF8yRC6g.js";var Ht={exports:{}},as={},os={exports:{}},Vs="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Xs=Vs,Js=Xs;function ls(){}function cs(){}cs.resetWarningCache=ls;var Qs=function(){function e(s,r,i,a,o,l){if(l!==Js){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}e.isRequired=e;function n(){return e}var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:cs,resetWarningCache:ls};return t.PropTypes=t,t};os.exports=Qs();var us=os.exports;function ds(e){var n,t,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e))for(n=0;n<e.length;n++)e[n]&&(t=ds(e[n]))&&(s&&(s+=" "),s+=t);else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function $n(){for(var e,n,t=0,s="";t<arguments.length;)(e=arguments[t++])&&(n=ds(e))&&(s&&(s+=" "),s+=n);return s}const er=Object.freeze(Object.defineProperty({__proto__:null,clsx:$n,default:$n},Symbol.toStringTag,{value:"Module"})),tr=Ys(er);var J={},De={};Object.defineProperty(De,"__esModule",{value:!0});De.dontSetMe=ar;De.findInArray=nr;De.int=ir;De.isFunction=sr;De.isNum=rr;function nr(e,n){for(let t=0,s=e.length;t<s;t++)if(n.apply(n,[e[t],t,e]))return e[t]}function sr(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function rr(e){return typeof e=="number"&&!isNaN(e)}function ir(e){return parseInt(e,10)}function ar(e,n,t){if(e[n])return new Error("Invalid prop ".concat(n," passed to ").concat(t," - do not set this, set it on the child."))}var tt={};Object.defineProperty(tt,"__esModule",{value:!0});tt.browserPrefixToKey=fs;tt.browserPrefixToStyle=or;tt.default=void 0;tt.getPrefix=hs;const tn=["Moz","Webkit","O","ms"];function hs(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const t=(e=window.document)===null||e===void 0||(e=e.documentElement)===null||e===void 0?void 0:e.style;if(!t||n in t)return"";for(let s=0;s<tn.length;s++)if(fs(n,tn[s])in t)return tn[s];return""}function fs(e,n){return n?"".concat(n).concat(lr(e)):e}function or(e,n){return n?"-".concat(n.toLowerCase(),"-").concat(e):e}function lr(e){let n="",t=!0;for(let s=0;s<e.length;s++)t?(n+=e[s].toUpperCase(),t=!1):e[s]==="-"?t=!0:n+=e[s];return n}tt.default=hs();Object.defineProperty(J,"__esModule",{value:!0});J.addClassName=ms;J.addEvent=dr;J.addUserSelectStyles=_r;J.createCSSTransform=br;J.createSVGTransform=xr;J.getTouch=wr;J.getTouchIdentifier=vr;J.getTranslation=xn;J.innerHeight=gr;J.innerWidth=mr;J.matchesSelector=gs;J.matchesSelectorAndParentsTo=ur;J.offsetXYFromParent=yr;J.outerHeight=fr;J.outerWidth=pr;J.removeClassName=ys;J.removeEvent=hr;J.removeUserSelectStyles=kr;var _e=De,Mn=cr(tt);function ps(e){if(typeof WeakMap!="function")return null;var n=new WeakMap,t=new WeakMap;return(ps=function(s){return s?t:n})(e)}function cr(e,n){if(e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=ps(n);if(t&&t.has(e))return t.get(e);var s={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(s,i,a):s[i]=e[i]}return s.default=e,t&&t.set(e,s),s}let jt="";function gs(e,n){return jt||(jt=(0,_e.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(t){return(0,_e.isFunction)(e[t])})),(0,_e.isFunction)(e[jt])?e[jt](n):!1}function ur(e,n,t){let s=e;do{if(gs(s,n))return!0;if(s===t)return!1;s=s.parentNode}while(s);return!1}function dr(e,n,t,s){if(!e)return;const r={capture:!0,...s};e.addEventListener?e.addEventListener(n,t,r):e.attachEvent?e.attachEvent("on"+n,t):e["on"+n]=t}function hr(e,n,t,s){if(!e)return;const r={capture:!0,...s};e.removeEventListener?e.removeEventListener(n,t,r):e.detachEvent?e.detachEvent("on"+n,t):e["on"+n]=null}function fr(e){let n=e.clientHeight;const t=e.ownerDocument.defaultView.getComputedStyle(e);return n+=(0,_e.int)(t.borderTopWidth),n+=(0,_e.int)(t.borderBottomWidth),n}function pr(e){let n=e.clientWidth;const t=e.ownerDocument.defaultView.getComputedStyle(e);return n+=(0,_e.int)(t.borderLeftWidth),n+=(0,_e.int)(t.borderRightWidth),n}function gr(e){let n=e.clientHeight;const t=e.ownerDocument.defaultView.getComputedStyle(e);return n-=(0,_e.int)(t.paddingTop),n-=(0,_e.int)(t.paddingBottom),n}function mr(e){let n=e.clientWidth;const t=e.ownerDocument.defaultView.getComputedStyle(e);return n-=(0,_e.int)(t.paddingLeft),n-=(0,_e.int)(t.paddingRight),n}function yr(e,n,t){const r=n===n.ownerDocument.body?{left:0,top:0}:n.getBoundingClientRect(),i=(e.clientX+n.scrollLeft-r.left)/t,a=(e.clientY+n.scrollTop-r.top)/t;return{x:i,y:a}}function br(e,n){const t=xn(e,n,"px");return{[(0,Mn.browserPrefixToKey)("transform",Mn.default)]:t}}function xr(e,n){return xn(e,n,"")}function xn(e,n,t){let{x:s,y:r}=e,i="translate(".concat(s).concat(t,",").concat(r).concat(t,")");if(n){const a="".concat(typeof n.x=="string"?n.x:n.x+t),o="".concat(typeof n.y=="string"?n.y:n.y+t);i="translate(".concat(a,", ").concat(o,")")+i}return i}function wr(e,n){return e.targetTouches&&(0,_e.findInArray)(e.targetTouches,t=>n===t.identifier)||e.changedTouches&&(0,_e.findInArray)(e.changedTouches,t=>n===t.identifier)}function vr(e){if(e.targetTouches&&e.targetTouches[0])return e.targetTouches[0].identifier;if(e.changedTouches&&e.changedTouches[0])return e.changedTouches[0].identifier}function _r(e){if(!e)return;let n=e.getElementById("react-draggable-style-el");n||(n=e.createElement("style"),n.type="text/css",n.id="react-draggable-style-el",n.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,n.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,e.getElementsByTagName("head")[0].appendChild(n)),e.body&&ms(e.body,"react-draggable-transparent-selection")}function kr(e){if(e)try{if(e.body&&ys(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{const n=(e.defaultView||window).getSelection();n&&n.type!=="Caret"&&n.removeAllRanges()}}catch{}}function ms(e,n){e.classList?e.classList.add(n):e.className.match(new RegExp("(?:^|\\s)".concat(n,"(?!\\S)")))||(e.className+=" ".concat(n))}function ys(e,n){e.classList?e.classList.remove(n):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(n,"(?!\\S)"),"g"),"")}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.canDragX=Ar;Oe.canDragY=Tr;Oe.createCoreData=Nr;Oe.createDraggableData=Fr;Oe.getBoundPosition=Sr;Oe.getControlPosition=Cr;Oe.snapToGrid=Er;var ye=De,at=J;function Sr(e,n,t){if(!e.props.bounds)return[n,t];let{bounds:s}=e.props;s=typeof s=="string"?s:Rr(s);const r=wn(e);if(typeof s=="string"){const{ownerDocument:i}=r,a=i.defaultView;let o;if(s==="parent"?o=r.parentNode:o=i.querySelector(s),!(o instanceof a.HTMLElement))throw new Error('Bounds selector "'+s+'" could not find an element.');const l=o,f=a.getComputedStyle(r),w=a.getComputedStyle(l);s={left:-r.offsetLeft+(0,ye.int)(w.paddingLeft)+(0,ye.int)(f.marginLeft),top:-r.offsetTop+(0,ye.int)(w.paddingTop)+(0,ye.int)(f.marginTop),right:(0,at.innerWidth)(l)-(0,at.outerWidth)(r)-r.offsetLeft+(0,ye.int)(w.paddingRight)-(0,ye.int)(f.marginRight),bottom:(0,at.innerHeight)(l)-(0,at.outerHeight)(r)-r.offsetTop+(0,ye.int)(w.paddingBottom)-(0,ye.int)(f.marginBottom)}}return(0,ye.isNum)(s.right)&&(n=Math.min(n,s.right)),(0,ye.isNum)(s.bottom)&&(t=Math.min(t,s.bottom)),(0,ye.isNum)(s.left)&&(n=Math.max(n,s.left)),(0,ye.isNum)(s.top)&&(t=Math.max(t,s.top)),[n,t]}function Er(e,n,t){const s=Math.round(n/e[0])*e[0],r=Math.round(t/e[1])*e[1];return[s,r]}function Ar(e){return e.props.axis==="both"||e.props.axis==="x"}function Tr(e){return e.props.axis==="both"||e.props.axis==="y"}function Cr(e,n,t){const s=typeof n=="number"?(0,at.getTouch)(e,n):null;if(typeof n=="number"&&!s)return null;const r=wn(t),i=t.props.offsetParent||r.offsetParent||r.ownerDocument.body;return(0,at.offsetXYFromParent)(s||e,i,t.props.scale)}function Nr(e,n,t){const s=!(0,ye.isNum)(e.lastX),r=wn(e);return s?{node:r,deltaX:0,deltaY:0,lastX:n,lastY:t,x:n,y:t}:{node:r,deltaX:n-e.lastX,deltaY:t-e.lastY,lastX:e.lastX,lastY:e.lastY,x:n,y:t}}function Fr(e,n){const t=e.props.scale;return{node:n.node,x:e.state.x+n.deltaX/t,y:e.state.y+n.deltaY/t,deltaX:n.deltaX/t,deltaY:n.deltaY/t,lastX:e.state.x,lastY:e.state.y}}function Rr(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function wn(e){const n=e.findDOMNode();if(!n)throw new Error("<DraggableCore>: Unmounted during event!");return n}var Yt={},Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.default=jr;function jr(){}Object.defineProperty(Yt,"__esModule",{value:!0});Yt.default=void 0;var nn=Mr(D),me=vn(us),$r=vn(rs),ce=J,qe=Oe,sn=De,gt=vn(Zt);function vn(e){return e&&e.__esModule?e:{default:e}}function bs(e){if(typeof WeakMap!="function")return null;var n=new WeakMap,t=new WeakMap;return(bs=function(s){return s?t:n})(e)}function Mr(e,n){if(e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=bs(n);if(t&&t.has(e))return t.get(e);var s={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(s,i,a):s[i]=e[i]}return s.default=e,t&&t.set(e,s),s}function fe(e,n,t){return n=Dr(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Dr(e){var n=Or(e,"string");return typeof n=="symbol"?n:String(n)}function Or(e,n){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var s=t.call(e,n||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}const Ee={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let Be=Ee.mouse,Kt=class extends nn.Component{constructor(){super(...arguments),fe(this,"dragging",!1),fe(this,"lastX",NaN),fe(this,"lastY",NaN),fe(this,"touchIdentifier",null),fe(this,"mounted",!1),fe(this,"handleDragStart",n=>{if(this.props.onMouseDown(n),!this.props.allowAnyClick&&typeof n.button=="number"&&n.button!==0)return!1;const t=this.findDOMNode();if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:s}=t;if(this.props.disabled||!(n.target instanceof s.defaultView.Node)||this.props.handle&&!(0,ce.matchesSelectorAndParentsTo)(n.target,this.props.handle,t)||this.props.cancel&&(0,ce.matchesSelectorAndParentsTo)(n.target,this.props.cancel,t))return;n.type==="touchstart"&&n.preventDefault();const r=(0,ce.getTouchIdentifier)(n);this.touchIdentifier=r;const i=(0,qe.getControlPosition)(n,r,this);if(i==null)return;const{x:a,y:o}=i,l=(0,qe.createCoreData)(this,a,o);(0,gt.default)("DraggableCore: handleDragStart: %j",l),(0,gt.default)("calling",this.props.onStart),!(this.props.onStart(n,l)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,ce.addUserSelectStyles)(s),this.dragging=!0,this.lastX=a,this.lastY=o,(0,ce.addEvent)(s,Be.move,this.handleDrag),(0,ce.addEvent)(s,Be.stop,this.handleDragStop))}),fe(this,"handleDrag",n=>{const t=(0,qe.getControlPosition)(n,this.touchIdentifier,this);if(t==null)return;let{x:s,y:r}=t;if(Array.isArray(this.props.grid)){let o=s-this.lastX,l=r-this.lastY;if([o,l]=(0,qe.snapToGrid)(this.props.grid,o,l),!o&&!l)return;s=this.lastX+o,r=this.lastY+l}const i=(0,qe.createCoreData)(this,s,r);if((0,gt.default)("DraggableCore: handleDrag: %j",i),this.props.onDrag(n,i)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.lastX=s,this.lastY=r}),fe(this,"handleDragStop",n=>{if(!this.dragging)return;const t=(0,qe.getControlPosition)(n,this.touchIdentifier,this);if(t==null)return;let{x:s,y:r}=t;if(Array.isArray(this.props.grid)){let l=s-this.lastX||0,f=r-this.lastY||0;[l,f]=(0,qe.snapToGrid)(this.props.grid,l,f),s=this.lastX+l,r=this.lastY+f}const i=(0,qe.createCoreData)(this,s,r);if(this.props.onStop(n,i)===!1||this.mounted===!1)return!1;const o=this.findDOMNode();o&&this.props.enableUserSelectHack&&(0,ce.removeUserSelectStyles)(o.ownerDocument),(0,gt.default)("DraggableCore: handleDragStop: %j",i),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,o&&((0,gt.default)("DraggableCore: Removing handlers"),(0,ce.removeEvent)(o.ownerDocument,Be.move,this.handleDrag),(0,ce.removeEvent)(o.ownerDocument,Be.stop,this.handleDragStop))}),fe(this,"onMouseDown",n=>(Be=Ee.mouse,this.handleDragStart(n))),fe(this,"onMouseUp",n=>(Be=Ee.mouse,this.handleDragStop(n))),fe(this,"onTouchStart",n=>(Be=Ee.touch,this.handleDragStart(n))),fe(this,"onTouchEnd",n=>(Be=Ee.touch,this.handleDragStop(n)))}componentDidMount(){this.mounted=!0;const n=this.findDOMNode();n&&(0,ce.addEvent)(n,Ee.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const n=this.findDOMNode();if(n){const{ownerDocument:t}=n;(0,ce.removeEvent)(t,Ee.mouse.move,this.handleDrag),(0,ce.removeEvent)(t,Ee.touch.move,this.handleDrag),(0,ce.removeEvent)(t,Ee.mouse.stop,this.handleDragStop),(0,ce.removeEvent)(t,Ee.touch.stop,this.handleDragStop),(0,ce.removeEvent)(n,Ee.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,ce.removeUserSelectStyles)(t)}}findDOMNode(){var n,t;return(n=this.props)!==null&&n!==void 0&&n.nodeRef?(t=this.props)===null||t===void 0||(t=t.nodeRef)===null||t===void 0?void 0:t.current:$r.default.findDOMNode(this)}render(){return nn.cloneElement(nn.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};Yt.default=Kt;fe(Kt,"displayName","DraggableCore");fe(Kt,"propTypes",{allowAnyClick:me.default.bool,children:me.default.node.isRequired,disabled:me.default.bool,enableUserSelectHack:me.default.bool,offsetParent:function(e,n){if(e[n]&&e[n].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:me.default.arrayOf(me.default.number),handle:me.default.string,cancel:me.default.string,nodeRef:me.default.object,onStart:me.default.func,onDrag:me.default.func,onStop:me.default.func,onMouseDown:me.default.func,scale:me.default.number,className:sn.dontSetMe,style:sn.dontSetMe,transform:sn.dontSetMe});fe(Kt,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DraggableCore",{enumerable:!0,get:function(){return l.default}}),e.default=void 0;var n=b(D),t=w(us),s=w(rs),r=w(tr),i=J,a=Oe,o=De,l=w(Yt),f=w(Zt);function w(u){return u&&u.__esModule?u:{default:u}}function v(u){if(typeof WeakMap!="function")return null;var h=new WeakMap,p=new WeakMap;return(v=function(g){return g?p:h})(u)}function b(u,h){if(u&&u.__esModule)return u;if(u===null||typeof u!="object"&&typeof u!="function")return{default:u};var p=v(h);if(p&&p.has(u))return p.get(u);var g={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in u)if(_!=="default"&&Object.prototype.hasOwnProperty.call(u,_)){var R=x?Object.getOwnPropertyDescriptor(u,_):null;R&&(R.get||R.set)?Object.defineProperty(g,_,R):g[_]=u[_]}return g.default=u,p&&p.set(u,g),g}function S(){return S=Object.assign?Object.assign.bind():function(u){for(var h=1;h<arguments.length;h++){var p=arguments[h];for(var g in p)Object.prototype.hasOwnProperty.call(p,g)&&(u[g]=p[g])}return u},S.apply(this,arguments)}function E(u,h,p){return h=T(h),h in u?Object.defineProperty(u,h,{value:p,enumerable:!0,configurable:!0,writable:!0}):u[h]=p,u}function T(u){var h=k(u,"string");return typeof h=="symbol"?h:String(h)}function k(u,h){if(typeof u!="object"||u===null)return u;var p=u[Symbol.toPrimitive];if(p!==void 0){var g=p.call(u,h||"default");if(typeof g!="object")return g;throw new TypeError("@@toPrimitive must return a primitive value.")}return(h==="string"?String:Number)(u)}class m extends n.Component{static getDerivedStateFromProps(h,p){let{position:g}=h,{prevPropsPosition:x}=p;return g&&(!x||g.x!==x.x||g.y!==x.y)?((0,f.default)("Draggable: getDerivedStateFromProps %j",{position:g,prevPropsPosition:x}),{x:g.x,y:g.y,prevPropsPosition:{...g}}):null}constructor(h){super(h),E(this,"onDragStart",(p,g)=>{if((0,f.default)("Draggable: onDragStart: %j",g),this.props.onStart(p,(0,a.createDraggableData)(this,g))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),E(this,"onDrag",(p,g)=>{if(!this.state.dragging)return!1;(0,f.default)("Draggable: onDrag: %j",g);const x=(0,a.createDraggableData)(this,g),_={x:x.x,y:x.y,slackX:0,slackY:0};if(this.props.bounds){const{x:y,y:F}=_;_.x+=this.state.slackX,_.y+=this.state.slackY;const[z,ne]=(0,a.getBoundPosition)(this,_.x,_.y);_.x=z,_.y=ne,_.slackX=this.state.slackX+(y-_.x),_.slackY=this.state.slackY+(F-_.y),x.x=_.x,x.y=_.y,x.deltaX=_.x-this.state.x,x.deltaY=_.y-this.state.y}if(this.props.onDrag(p,x)===!1)return!1;this.setState(_)}),E(this,"onDragStop",(p,g)=>{if(!this.state.dragging||this.props.onStop(p,(0,a.createDraggableData)(this,g))===!1)return!1;(0,f.default)("Draggable: onDragStop: %j",g);const _={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:y,y:F}=this.props.position;_.x=y,_.y=F}this.setState(_)}),this.state={dragging:!1,dragged:!1,x:h.position?h.position.x:h.defaultPosition.x,y:h.position?h.position.y:h.defaultPosition.y,prevPropsPosition:{...h.position},slackX:0,slackY:0,isElementSVG:!1},h.position&&!(h.onDrag||h.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var h,p;return(h=(p=this.props)===null||p===void 0||(p=p.nodeRef)===null||p===void 0?void 0:p.current)!==null&&h!==void 0?h:s.default.findDOMNode(this)}render(){const{axis:h,bounds:p,children:g,defaultPosition:x,defaultClassName:_,defaultClassNameDragging:R,defaultClassNameDragged:y,position:F,positionOffset:z,scale:ne,...Le}=this.props;let O={},P=null;const L=!!!F||this.state.dragging,H=F||x,re={x:(0,a.canDragX)(this)&&L?this.state.x:H.x,y:(0,a.canDragY)(this)&&L?this.state.y:H.y};this.state.isElementSVG?P=(0,i.createSVGTransform)(re,z):O=(0,i.createCSSTransform)(re,z);const Me=(0,r.default)(g.props.className||"",_,{[R]:this.state.dragging,[y]:this.state.dragged});return n.createElement(l.default,S({},Le,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),n.cloneElement(n.Children.only(g),{className:Me,style:{...g.props.style,...O},transform:P}))}}e.default=m,E(m,"displayName","Draggable"),E(m,"propTypes",{...l.default.propTypes,axis:t.default.oneOf(["both","x","y","none"]),bounds:t.default.oneOfType([t.default.shape({left:t.default.number,right:t.default.number,top:t.default.number,bottom:t.default.number}),t.default.string,t.default.oneOf([!1])]),defaultClassName:t.default.string,defaultClassNameDragging:t.default.string,defaultClassNameDragged:t.default.string,defaultPosition:t.default.shape({x:t.default.number,y:t.default.number}),positionOffset:t.default.shape({x:t.default.oneOfType([t.default.number,t.default.string]),y:t.default.oneOfType([t.default.number,t.default.string])}),position:t.default.shape({x:t.default.number,y:t.default.number}),className:o.dontSetMe,style:o.dontSetMe,transform:o.dontSetMe}),E(m,"defaultProps",{...l.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(as);const{default:xs,DraggableCore:Ir}=as;Ht.exports=xs;Ht.exports.default=xs;Ht.exports.DraggableCore=Ir;var zr=Ht.exports;const Pr=is(zr);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=oe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=oe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=oe("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=oe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=oe("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=oe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=oe("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=oe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=oe("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=oe("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=oe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=oe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=oe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=oe("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ee=ft((e,n)=>({session:null,sessions:[],isLoading:!1,error:null,setSession:t=>e({session:t,error:null}),clearSession:()=>{e({session:null,error:null}),n().unsubscribeFromSession()},joinSession:async t=>{e({isLoading:!0,error:null});try{const{data:s,error:r}=await M.from("sessions").select("*").eq("code",t.toUpperCase()).eq("status","active").single();if(r)throw new Error("Invalid session code or session has ended");if(!s)throw new Error("Session not found");const i={...s,status:s.status};e({session:i}),n().subscribeToSessionUpdates()}catch(s){e({error:s.message})}finally{e({isLoading:!1})}},createSession:async(t,s)=>{e({isLoading:!0,error:null});try{const r=Math.random().toString(36).substring(2,8).toUpperCase(),i=(await M.auth.getUser()).data.user;if(!i)throw new Error("Not authenticated");const{data:a,error:o}=await M.from("sessions").insert([{title:t,description:s,code:r,professor_id:i.id,metadata:{}}]).select().single();if(o)throw o;if(a){const l={...a,status:a.status};e({session:l}),n().subscribeToSessionUpdates(),await n().loadSessions()}}catch(r){e({error:r.message})}finally{e({isLoading:!1})}},endSession:async()=>{const t=n().session;if(t){e({isLoading:!0,error:null});try{const{error:s}=await M.from("sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",t.id).eq("status","active");if(s)throw s;const r={...t,status:"ended",ended_at:new Date().toISOString()};e({session:r,sessions:n().sessions.map(i=>i.id===t.id?r:i),error:null}),await n().loadSessions()}catch(s){e({error:s.message})}finally{e({isLoading:!1})}}},updateSessionMetadata:async t=>{const s=n().session;if(s){e({isLoading:!0,error:null});try{const{error:r}=await M.from("sessions").update({metadata:{...s.metadata,...t}}).eq("id",s.id).eq("status","active");if(r)throw r;e({session:{...s,metadata:{...s.metadata,...t}}})}catch(r){e({error:r.message})}finally{e({isLoading:!1})}}},loadSessions:async()=>{e({isLoading:!0,error:null});try{const{data:t,error:s}=await M.from("session_history").select("*").order("created_at",{ascending:!1});if(s)throw s;const r=(t||[]).map(i=>({...i,status:i.status}));e({sessions:r})}catch(t){e({error:t.message})}finally{e({isLoading:!1})}},subscribeToSessionUpdates:()=>{const t=n().session;if(!t)return;const s=M.channel(`session:${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"sessions",filter:`id=eq.${t.id}`},r=>{if(r.eventType==="UPDATE"){const i={...n().session,...r.new,status:r.new.status};e({session:i})}}).subscribe();return()=>{s.unsubscribe()}},unsubscribeFromSession:()=>{const t=n().session;t&&M.channel(`session:${t.id}`).unsubscribe()}}));/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ot;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(ot||(ot={}));var lt;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(lt||(lt={}));var On;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(On||(On={}));var In;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(In||(In={}));var Lt;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.OTHER="OTHER"})(Lt||(Lt={}));var zn;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(zn||(zn={}));/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt extends Error{constructor(n){super(`[GoogleGenerativeAI Error]: ${n}`)}}class Pn extends vt{constructor(n,t){super(n),this.response=t}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr="https://generativelanguage.googleapis.com",Zr="v1",Kr="0.2.1",Vr="genai-js";var Qe;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Qe||(Qe={}));class At{constructor(n,t,s,r){this.model=n,this.task=t,this.apiKey=s,this.stream=r}toString(){let n=`${Yr}/${Zr}/${this.model}:${this.task}`;return this.stream&&(n+="?alt=sse"),n}}function Xr(){return`${Vr}/${Kr}`}async function Tt(e,n,t){let s;try{if(s=await fetch(e.toString(),Object.assign(Object.assign({},Jr(t)),{method:"POST",headers:{"Content-Type":"application/json","x-goog-api-client":Xr(),"x-goog-api-key":e.apiKey},body:n})),!s.ok){let r="";try{const i=await s.json();r=i.error.message,i.error.details&&(r+=` ${JSON.stringify(i.error.details)}`)}catch{}throw new Error(`[${s.status} ${s.statusText}] ${r}`)}}catch(r){const i=new vt(`Error fetching from ${e.toString()}: ${r.message}`);throw i.stack=r.stack,i}return s}function Jr(e){const n={};if((e==null?void 0:e.timeout)>=0){const t=new AbortController,s=t.signal;setTimeout(()=>t.abort(),e.timeout),n.signal=s}return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Ss(e.candidates[0]))throw new Pn(`${Ut(e)}`,e);return Qr(e)}else if(e.promptFeedback)throw new Pn(`Text not available. ${Ut(e)}`,e);return""},e}function Qr(e){var n,t,s,r;return!((r=(s=(t=(n=e.candidates)===null||n===void 0?void 0:n[0].content)===null||t===void 0?void 0:t.parts)===null||s===void 0?void 0:s[0])===null||r===void 0)&&r.text?e.candidates[0].content.parts[0].text:""}const ei=[Lt.RECITATION,Lt.SAFETY];function Ss(e){return!!e.finishReason&&ei.includes(e.finishReason)}function Ut(e){var n,t,s;let r="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)r+="Response was blocked",!((n=e.promptFeedback)===null||n===void 0)&&n.blockReason&&(r+=` due to ${e.promptFeedback.blockReason}`),!((t=e.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(r+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((s=e.candidates)===null||s===void 0)&&s[0]){const i=e.candidates[0];Ss(i)&&(r+=`Candidate was blocked due to ${i.finishReason}`,i.finishMessage&&(r+=`: ${i.finishMessage}`))}return r}function _t(e){return this instanceof _t?(this.v=e,this):new _t(e)}function ti(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(e,n||[]),r,i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(b){s[b]&&(r[b]=function(S){return new Promise(function(E,T){i.push([b,S,E,T])>1||o(b,S)})})}function o(b,S){try{l(s[b](S))}catch(E){v(i[0][3],E)}}function l(b){b.value instanceof _t?Promise.resolve(b.value.v).then(f,w):v(i[0][2],b)}function f(b){o("next",b)}function w(b){o("throw",b)}function v(b,S){b(S),i.shift(),i.length&&o(i[0][0],i[0][1])}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function ni(e){const n=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=ii(n),[s,r]=t.tee();return{stream:ri(s),response:si(r)}}async function si(e){const n=[],t=e.getReader();for(;;){const{done:s,value:r}=await t.read();if(s)return _n(ai(n));n.push(r)}}function ri(e){return ti(this,arguments,function*(){const t=e.getReader();for(;;){const{value:s,done:r}=yield _t(t.read());if(r)break;yield yield _t(_n(s))}})}function ii(e){const n=e.getReader();return new ReadableStream({start(s){let r="";return i();function i(){return n.read().then(({value:a,done:o})=>{if(o){if(r.trim()){s.error(new vt("Failed to parse stream"));return}s.close();return}r+=a;let l=r.match(Ln),f;for(;l;){try{f=JSON.parse(l[1])}catch{s.error(new vt(`Error parsing JSON response: "${l[1]}"`));return}s.enqueue(f),r=r.substring(l[0].length),l=r.match(Ln)}return i()})}}})}function ai(e){const n=e[e.length-1],t={promptFeedback:n==null?void 0:n.promptFeedback};for(const s of e)if(s.candidates)for(const r of s.candidates){const i=r.index;if(t.candidates||(t.candidates=[]),t.candidates[i]||(t.candidates[i]={index:r.index}),t.candidates[i].citationMetadata=r.citationMetadata,t.candidates[i].finishReason=r.finishReason,t.candidates[i].finishMessage=r.finishMessage,t.candidates[i].safetyRatings=r.safetyRatings,r.content&&r.content.parts){t.candidates[i].content||(t.candidates[i].content={role:r.content.role||"user",parts:[{text:""}]});for(const a of r.content.parts)a.text&&(t.candidates[i].content.parts[0].text+=a.text)}}return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Es(e,n,t,s){const r=new At(n,Qe.STREAM_GENERATE_CONTENT,e,!0),i=await Tt(r,JSON.stringify(t),s);return ni(i)}async function As(e,n,t,s){const r=new At(n,Qe.GENERATE_CONTENT,e,!1),a=await(await Tt(r,JSON.stringify(t),s)).json();return{response:_n(a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(e,n){let t=[];if(typeof e=="string")t=[{text:e}];else for(const s of e)typeof s=="string"?t.push({text:s}):t.push(s);return{role:n,parts:t}}function rn(e){return e.contents?e:{contents:[bt(e,"user")]}}function oi(e){return typeof e=="string"||Array.isArray(e)?{content:bt(e,"user")}:e}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un="SILENT_ERROR";class li{constructor(n,t,s,r){this.model=t,this.params=s,this.requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=n,s!=null&&s.history&&(this._history=s.history.map(i=>{if(!i.role)throw new Error("Missing role for history item: "+JSON.stringify(i));return bt(i.parts,i.role)}))}async getHistory(){return await this._sendPromise,this._history}async sendMessage(n){var t,s;await this._sendPromise;const r=bt(n,"user"),i={safetySettings:(t=this.params)===null||t===void 0?void 0:t.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,contents:[...this._history,r]};let a;return this._sendPromise=this._sendPromise.then(()=>As(this._apiKey,this.model,i,this.requestOptions)).then(o=>{var l;if(o.response.candidates&&o.response.candidates.length>0){this._history.push(r);const f=Object.assign({parts:[],role:"model"},(l=o.response.candidates)===null||l===void 0?void 0:l[0].content);this._history.push(f)}else{const f=Ut(o.response);f&&console.warn(`sendMessage() was unsuccessful. ${f}. Inspect response object for details.`)}a=o}),await this._sendPromise,a}async sendMessageStream(n){var t,s;await this._sendPromise;const r=bt(n,"user"),i={safetySettings:(t=this.params)===null||t===void 0?void 0:t.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,contents:[...this._history,r]},a=Es(this._apiKey,this.model,i,this.requestOptions);return this._sendPromise=this._sendPromise.then(()=>a).catch(o=>{throw new Error(Un)}).then(o=>o.response).then(o=>{if(o.candidates&&o.candidates.length>0){this._history.push(r);const l=Object.assign({},o.candidates[0].content);l.role||(l.role="model"),this._history.push(l)}else{const l=Ut(o);l&&console.warn(`sendMessageStream() was unsuccessful. ${l}. Inspect response object for details.`)}}).catch(o=>{o.message!==Un&&console.error(o)}),a}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ci(e,n,t,s){const r=new At(n,Qe.COUNT_TOKENS,e,!1);return(await Tt(r,JSON.stringify(Object.assign(Object.assign({},t),{model:n})),s)).json()}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ui(e,n,t,s){const r=new At(n,Qe.EMBED_CONTENT,e,!1);return(await Tt(r,JSON.stringify(t),s)).json()}async function di(e,n,t,s){const r=new At(n,Qe.BATCH_EMBED_CONTENTS,e,!1),i=t.requests.map(o=>Object.assign(Object.assign({},o),{model:n}));return(await Tt(r,JSON.stringify({requests:i}),s)).json()}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(n,t,s){this.apiKey=n,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.requestOptions=s||{}}async generateContent(n){const t=rn(n);return As(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings},t),this.requestOptions)}async generateContentStream(n){const t=rn(n);return Es(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings},t),this.requestOptions)}startChat(n){return new li(this.apiKey,this.model,n,this.requestOptions)}async countTokens(n){const t=rn(n);return ci(this.apiKey,this.model,t)}async embedContent(n){const t=oi(n);return ui(this.apiKey,this.model,t)}async batchEmbedContents(n){return di(this.apiKey,this.model,n,this.requestOptions)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(n){this.apiKey=n}getGenerativeModel(n,t){if(!n.model)throw new vt("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new hi(this.apiKey,n,t)}}const rt=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Cs=new Set,ln=typeof process=="object"&&process?process:{},Ns=(e,n,t,s)=>{typeof ln.emitWarning=="function"?ln.emitWarning(e,n,t,s):console.error(`[${t}] ${n}: ${e}`)};let qt=globalThis.AbortController,qn=globalThis.AbortSignal;var ts;if(typeof qt>"u"){qn=class{constructor(){K(this,"onabort");K(this,"_onabort",[]);K(this,"reason");K(this,"aborted",!1)}addEventListener(s,r){this._onabort.push(r)}},qt=class{constructor(){K(this,"signal",new qn);n()}abort(s){var r,i;if(!this.signal.aborted){this.signal.reason=s,this.signal.aborted=!0;for(const a of this.signal._onabort)a(s);(i=(r=this.signal).onabort)==null||i.call(r,s)}}};let e=((ts=ln.env)==null?void 0:ts.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const n=()=>{e&&(e=!1,Ns("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",n))}}const fi=e=>!Cs.has(e),We=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),Fs=e=>We(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?Mt:null:null;class Mt extends Array{constructor(n){super(n),this.fill(0)}}var ct;const Ve=class Ve{constructor(n,t){K(this,"heap");K(this,"length");if(!c(Ve,ct))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(n),this.length=0}static create(n){const t=Fs(n);if(!t)return[];$(Ve,ct,!0);const s=new Ve(n,t);return $(Ve,ct,!1),s}push(n){this.heap[this.length++]=n}pop(){return this.heap[--this.length]}};ct=new WeakMap,U(Ve,ct,!1);let cn=Ve;var ns,ss,Ae,be,Te,Ce,ut,dt,se,Ne,te,Z,I,pe,xe,ue,ie,Fe,ae,Re,je,we,$e,Ze,ge,A,dn,Xe,Ie,kt,ve,Rs,Je,ht,St,Ge,He,hn,Dt,Ot,Y,fn,yt,Ye,pn;const Nn=class Nn{constructor(n){U(this,A);U(this,Ae);U(this,be);U(this,Te);U(this,Ce);U(this,ut);U(this,dt);K(this,"ttl");K(this,"ttlResolution");K(this,"ttlAutopurge");K(this,"updateAgeOnGet");K(this,"updateAgeOnHas");K(this,"allowStale");K(this,"noDisposeOnSet");K(this,"noUpdateTTL");K(this,"maxEntrySize");K(this,"sizeCalculation");K(this,"noDeleteOnFetchRejection");K(this,"noDeleteOnStaleGet");K(this,"allowStaleOnFetchAbort");K(this,"allowStaleOnFetchRejection");K(this,"ignoreFetchAbort");U(this,se);U(this,Ne);U(this,te);U(this,Z);U(this,I);U(this,pe);U(this,xe);U(this,ue);U(this,ie);U(this,Fe);U(this,ae);U(this,Re);U(this,je);U(this,we);U(this,$e);U(this,Ze);U(this,ge);U(this,Xe,()=>{});U(this,Ie,()=>{});U(this,kt,()=>{});U(this,ve,()=>!1);U(this,Je,n=>{});U(this,ht,(n,t,s)=>{});U(this,St,(n,t,s,r)=>{if(s||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});K(this,ns,"LRUCache");const{max:t=0,ttl:s,ttlResolution:r=1,ttlAutopurge:i,updateAgeOnGet:a,updateAgeOnHas:o,allowStale:l,dispose:f,disposeAfter:w,noDisposeOnSet:v,noUpdateTTL:b,maxSize:S=0,maxEntrySize:E=0,sizeCalculation:T,fetchMethod:k,memoMethod:m,noDeleteOnFetchRejection:u,noDeleteOnStaleGet:h,allowStaleOnFetchRejection:p,allowStaleOnFetchAbort:g,ignoreFetchAbort:x}=n;if(t!==0&&!We(t))throw new TypeError("max option must be a nonnegative integer");const _=t?Fs(t):Array;if(!_)throw new Error("invalid max value: "+t);if($(this,Ae,t),$(this,be,S),this.maxEntrySize=E||c(this,be),this.sizeCalculation=T,this.sizeCalculation){if(!c(this,be)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(m!==void 0&&typeof m!="function")throw new TypeError("memoMethod must be a function if defined");if($(this,dt,m),k!==void 0&&typeof k!="function")throw new TypeError("fetchMethod must be a function if specified");if($(this,ut,k),$(this,Ze,!!k),$(this,te,new Map),$(this,Z,new Array(t).fill(void 0)),$(this,I,new Array(t).fill(void 0)),$(this,pe,new _(t)),$(this,xe,new _(t)),$(this,ue,0),$(this,ie,0),$(this,Fe,cn.create(t)),$(this,se,0),$(this,Ne,0),typeof f=="function"&&$(this,Te,f),typeof w=="function"?($(this,Ce,w),$(this,ae,[])):($(this,Ce,void 0),$(this,ae,void 0)),$(this,$e,!!c(this,Te)),$(this,ge,!!c(this,Ce)),this.noDisposeOnSet=!!v,this.noUpdateTTL=!!b,this.noDeleteOnFetchRejection=!!u,this.allowStaleOnFetchRejection=!!p,this.allowStaleOnFetchAbort=!!g,this.ignoreFetchAbort=!!x,this.maxEntrySize!==0){if(c(this,be)!==0&&!We(c(this,be)))throw new TypeError("maxSize must be a positive integer if specified");if(!We(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");N(this,A,Rs).call(this)}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!h,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!o,this.ttlResolution=We(r)||r===0?r:1,this.ttlAutopurge=!!i,this.ttl=s||0,this.ttl){if(!We(this.ttl))throw new TypeError("ttl must be a positive integer if specified");N(this,A,dn).call(this)}if(c(this,Ae)===0&&this.ttl===0&&c(this,be)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!c(this,Ae)&&!c(this,be)){const R="LRU_CACHE_UNBOUNDED";fi(R)&&(Cs.add(R),Ns("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",R,Nn))}}static unsafeExposeInternals(n){return{starts:c(n,je),ttls:c(n,we),sizes:c(n,Re),keyMap:c(n,te),keyList:c(n,Z),valList:c(n,I),next:c(n,pe),prev:c(n,xe),get head(){return c(n,ue)},get tail(){return c(n,ie)},free:c(n,Fe),isBackgroundFetch:t=>{var s;return N(s=n,A,Y).call(s,t)},backgroundFetch:(t,s,r,i)=>{var a;return N(a=n,A,Ot).call(a,t,s,r,i)},moveToTail:t=>{var s;return N(s=n,A,yt).call(s,t)},indexes:t=>{var s;return N(s=n,A,Ge).call(s,t)},rindexes:t=>{var s;return N(s=n,A,He).call(s,t)},isStale:t=>{var s;return c(s=n,ve).call(s,t)}}}get max(){return c(this,Ae)}get maxSize(){return c(this,be)}get calculatedSize(){return c(this,Ne)}get size(){return c(this,se)}get fetchMethod(){return c(this,ut)}get memoMethod(){return c(this,dt)}get dispose(){return c(this,Te)}get disposeAfter(){return c(this,Ce)}getRemainingTTL(n){return c(this,te).has(n)?1/0:0}*entries(){for(const n of N(this,A,Ge).call(this))c(this,I)[n]!==void 0&&c(this,Z)[n]!==void 0&&!N(this,A,Y).call(this,c(this,I)[n])&&(yield[c(this,Z)[n],c(this,I)[n]])}*rentries(){for(const n of N(this,A,He).call(this))c(this,I)[n]!==void 0&&c(this,Z)[n]!==void 0&&!N(this,A,Y).call(this,c(this,I)[n])&&(yield[c(this,Z)[n],c(this,I)[n]])}*keys(){for(const n of N(this,A,Ge).call(this)){const t=c(this,Z)[n];t!==void 0&&!N(this,A,Y).call(this,c(this,I)[n])&&(yield t)}}*rkeys(){for(const n of N(this,A,He).call(this)){const t=c(this,Z)[n];t!==void 0&&!N(this,A,Y).call(this,c(this,I)[n])&&(yield t)}}*values(){for(const n of N(this,A,Ge).call(this))c(this,I)[n]!==void 0&&!N(this,A,Y).call(this,c(this,I)[n])&&(yield c(this,I)[n])}*rvalues(){for(const n of N(this,A,He).call(this))c(this,I)[n]!==void 0&&!N(this,A,Y).call(this,c(this,I)[n])&&(yield c(this,I)[n])}[(ss=Symbol.iterator,ns=Symbol.toStringTag,ss)](){return this.entries()}find(n,t={}){for(const s of N(this,A,Ge).call(this)){const r=c(this,I)[s],i=N(this,A,Y).call(this,r)?r.__staleWhileFetching:r;if(i!==void 0&&n(i,c(this,Z)[s],this))return this.get(c(this,Z)[s],t)}}forEach(n,t=this){for(const s of N(this,A,Ge).call(this)){const r=c(this,I)[s],i=N(this,A,Y).call(this,r)?r.__staleWhileFetching:r;i!==void 0&&n.call(t,i,c(this,Z)[s],this)}}rforEach(n,t=this){for(const s of N(this,A,He).call(this)){const r=c(this,I)[s],i=N(this,A,Y).call(this,r)?r.__staleWhileFetching:r;i!==void 0&&n.call(t,i,c(this,Z)[s],this)}}purgeStale(){let n=!1;for(const t of N(this,A,He).call(this,{allowStale:!0}))c(this,ve).call(this,t)&&(N(this,A,Ye).call(this,c(this,Z)[t],"expire"),n=!0);return n}info(n){const t=c(this,te).get(n);if(t===void 0)return;const s=c(this,I)[t],r=N(this,A,Y).call(this,s)?s.__staleWhileFetching:s;if(r===void 0)return;const i={value:r};if(c(this,we)&&c(this,je)){const a=c(this,we)[t],o=c(this,je)[t];if(a&&o){const l=a-(rt.now()-o);i.ttl=l,i.start=Date.now()}}return c(this,Re)&&(i.size=c(this,Re)[t]),i}dump(){const n=[];for(const t of N(this,A,Ge).call(this,{allowStale:!0})){const s=c(this,Z)[t],r=c(this,I)[t],i=N(this,A,Y).call(this,r)?r.__staleWhileFetching:r;if(i===void 0||s===void 0)continue;const a={value:i};if(c(this,we)&&c(this,je)){a.ttl=c(this,we)[t];const o=rt.now()-c(this,je)[t];a.start=Math.floor(Date.now()-o)}c(this,Re)&&(a.size=c(this,Re)[t]),n.unshift([s,a])}return n}load(n){this.clear();for(const[t,s]of n){if(s.start){const r=Date.now()-s.start;s.start=rt.now()-r}this.set(t,s.value,s)}}set(n,t,s={}){var b,S,E,T,k;if(t===void 0)return this.delete(n),this;const{ttl:r=this.ttl,start:i,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:o=this.sizeCalculation,status:l}=s;let{noUpdateTTL:f=this.noUpdateTTL}=s;const w=c(this,St).call(this,n,t,s.size||0,o);if(this.maxEntrySize&&w>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),N(this,A,Ye).call(this,n,"set"),this;let v=c(this,se)===0?void 0:c(this,te).get(n);if(v===void 0)v=c(this,se)===0?c(this,ie):c(this,Fe).length!==0?c(this,Fe).pop():c(this,se)===c(this,Ae)?N(this,A,Dt).call(this,!1):c(this,se),c(this,Z)[v]=n,c(this,I)[v]=t,c(this,te).set(n,v),c(this,pe)[c(this,ie)]=v,c(this,xe)[v]=c(this,ie),$(this,ie,v),Rt(this,se)._++,c(this,ht).call(this,v,w,l),l&&(l.set="add"),f=!1;else{N(this,A,yt).call(this,v);const m=c(this,I)[v];if(t!==m){if(c(this,Ze)&&N(this,A,Y).call(this,m)){m.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:u}=m;u!==void 0&&!a&&(c(this,$e)&&((b=c(this,Te))==null||b.call(this,u,n,"set")),c(this,ge)&&((S=c(this,ae))==null||S.push([u,n,"set"])))}else a||(c(this,$e)&&((E=c(this,Te))==null||E.call(this,m,n,"set")),c(this,ge)&&((T=c(this,ae))==null||T.push([m,n,"set"])));if(c(this,Je).call(this,v),c(this,ht).call(this,v,w,l),c(this,I)[v]=t,l){l.set="replace";const u=m&&N(this,A,Y).call(this,m)?m.__staleWhileFetching:m;u!==void 0&&(l.oldValue=u)}}else l&&(l.set="update")}if(r!==0&&!c(this,we)&&N(this,A,dn).call(this),c(this,we)&&(f||c(this,kt).call(this,v,r,i),l&&c(this,Ie).call(this,l,v)),!a&&c(this,ge)&&c(this,ae)){const m=c(this,ae);let u;for(;u=m==null?void 0:m.shift();)(k=c(this,Ce))==null||k.call(this,...u)}return this}pop(){var n;try{for(;c(this,se);){const t=c(this,I)[c(this,ue)];if(N(this,A,Dt).call(this,!0),N(this,A,Y).call(this,t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(c(this,ge)&&c(this,ae)){const t=c(this,ae);let s;for(;s=t==null?void 0:t.shift();)(n=c(this,Ce))==null||n.call(this,...s)}}}has(n,t={}){const{updateAgeOnHas:s=this.updateAgeOnHas,status:r}=t,i=c(this,te).get(n);if(i!==void 0){const a=c(this,I)[i];if(N(this,A,Y).call(this,a)&&a.__staleWhileFetching===void 0)return!1;if(c(this,ve).call(this,i))r&&(r.has="stale",c(this,Ie).call(this,r,i));else return s&&c(this,Xe).call(this,i),r&&(r.has="hit",c(this,Ie).call(this,r,i)),!0}else r&&(r.has="miss");return!1}peek(n,t={}){const{allowStale:s=this.allowStale}=t,r=c(this,te).get(n);if(r===void 0||!s&&c(this,ve).call(this,r))return;const i=c(this,I)[r];return N(this,A,Y).call(this,i)?i.__staleWhileFetching:i}async fetch(n,t={}){const{allowStale:s=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:o=this.noDisposeOnSet,size:l=0,sizeCalculation:f=this.sizeCalculation,noUpdateTTL:w=this.noUpdateTTL,noDeleteOnFetchRejection:v=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:b=this.allowStaleOnFetchRejection,ignoreFetchAbort:S=this.ignoreFetchAbort,allowStaleOnFetchAbort:E=this.allowStaleOnFetchAbort,context:T,forceRefresh:k=!1,status:m,signal:u}=t;if(!c(this,Ze))return m&&(m.fetch="get"),this.get(n,{allowStale:s,updateAgeOnGet:r,noDeleteOnStaleGet:i,status:m});const h={allowStale:s,updateAgeOnGet:r,noDeleteOnStaleGet:i,ttl:a,noDisposeOnSet:o,size:l,sizeCalculation:f,noUpdateTTL:w,noDeleteOnFetchRejection:v,allowStaleOnFetchRejection:b,allowStaleOnFetchAbort:E,ignoreFetchAbort:S,status:m,signal:u};let p=c(this,te).get(n);if(p===void 0){m&&(m.fetch="miss");const g=N(this,A,Ot).call(this,n,p,h,T);return g.__returned=g}else{const g=c(this,I)[p];if(N(this,A,Y).call(this,g)){const F=s&&g.__staleWhileFetching!==void 0;return m&&(m.fetch="inflight",F&&(m.returnedStale=!0)),F?g.__staleWhileFetching:g.__returned=g}const x=c(this,ve).call(this,p);if(!k&&!x)return m&&(m.fetch="hit"),N(this,A,yt).call(this,p),r&&c(this,Xe).call(this,p),m&&c(this,Ie).call(this,m,p),g;const _=N(this,A,Ot).call(this,n,p,h,T),y=_.__staleWhileFetching!==void 0&&s;return m&&(m.fetch=x?"stale":"refresh",y&&x&&(m.returnedStale=!0)),y?_.__staleWhileFetching:_.__returned=_}}async forceFetch(n,t={}){const s=await this.fetch(n,t);if(s===void 0)throw new Error("fetch() returned undefined");return s}memo(n,t={}){const s=c(this,dt);if(!s)throw new Error("no memoMethod provided to constructor");const{context:r,forceRefresh:i,...a}=t,o=this.get(n,a);if(!i&&o!==void 0)return o;const l=s(n,o,{options:a,context:r});return this.set(n,l,a),l}get(n,t={}){const{allowStale:s=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,status:a}=t,o=c(this,te).get(n);if(o!==void 0){const l=c(this,I)[o],f=N(this,A,Y).call(this,l);return a&&c(this,Ie).call(this,a,o),c(this,ve).call(this,o)?(a&&(a.get="stale"),f?(a&&s&&l.__staleWhileFetching!==void 0&&(a.returnedStale=!0),s?l.__staleWhileFetching:void 0):(i||N(this,A,Ye).call(this,n,"expire"),a&&s&&(a.returnedStale=!0),s?l:void 0)):(a&&(a.get="hit"),f?l.__staleWhileFetching:(N(this,A,yt).call(this,o),r&&c(this,Xe).call(this,o),l))}else a&&(a.get="miss")}delete(n){return N(this,A,Ye).call(this,n,"delete")}clear(){return N(this,A,pn).call(this,"delete")}};Ae=new WeakMap,be=new WeakMap,Te=new WeakMap,Ce=new WeakMap,ut=new WeakMap,dt=new WeakMap,se=new WeakMap,Ne=new WeakMap,te=new WeakMap,Z=new WeakMap,I=new WeakMap,pe=new WeakMap,xe=new WeakMap,ue=new WeakMap,ie=new WeakMap,Fe=new WeakMap,ae=new WeakMap,Re=new WeakMap,je=new WeakMap,we=new WeakMap,$e=new WeakMap,Ze=new WeakMap,ge=new WeakMap,A=new WeakSet,dn=function(){const n=new Mt(c(this,Ae)),t=new Mt(c(this,Ae));$(this,we,n),$(this,je,t),$(this,kt,(i,a,o=rt.now())=>{if(t[i]=a!==0?o:0,n[i]=a,a!==0&&this.ttlAutopurge){const l=setTimeout(()=>{c(this,ve).call(this,i)&&N(this,A,Ye).call(this,c(this,Z)[i],"expire")},a+1);l.unref&&l.unref()}}),$(this,Xe,i=>{t[i]=n[i]!==0?rt.now():0}),$(this,Ie,(i,a)=>{if(n[a]){const o=n[a],l=t[a];if(!o||!l)return;i.ttl=o,i.start=l,i.now=s||r();const f=i.now-l;i.remainingTTL=o-f}});let s=0;const r=()=>{const i=rt.now();if(this.ttlResolution>0){s=i;const a=setTimeout(()=>s=0,this.ttlResolution);a.unref&&a.unref()}return i};this.getRemainingTTL=i=>{const a=c(this,te).get(i);if(a===void 0)return 0;const o=n[a],l=t[a];if(!o||!l)return 1/0;const f=(s||r())-l;return o-f},$(this,ve,i=>{const a=t[i],o=n[i];return!!o&&!!a&&(s||r())-a>o})},Xe=new WeakMap,Ie=new WeakMap,kt=new WeakMap,ve=new WeakMap,Rs=function(){const n=new Mt(c(this,Ae));$(this,Ne,0),$(this,Re,n),$(this,Je,t=>{$(this,Ne,c(this,Ne)-n[t]),n[t]=0}),$(this,St,(t,s,r,i)=>{if(N(this,A,Y).call(this,s))return 0;if(!We(r))if(i){if(typeof i!="function")throw new TypeError("sizeCalculation must be a function");if(r=i(s,t),!We(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return r}),$(this,ht,(t,s,r)=>{if(n[t]=s,c(this,be)){const i=c(this,be)-n[t];for(;c(this,Ne)>i;)N(this,A,Dt).call(this,!0)}$(this,Ne,c(this,Ne)+n[t]),r&&(r.entrySize=s,r.totalCalculatedSize=c(this,Ne))})},Je=new WeakMap,ht=new WeakMap,St=new WeakMap,Ge=function*({allowStale:n=this.allowStale}={}){if(c(this,se))for(let t=c(this,ie);!(!N(this,A,hn).call(this,t)||((n||!c(this,ve).call(this,t))&&(yield t),t===c(this,ue)));)t=c(this,xe)[t]},He=function*({allowStale:n=this.allowStale}={}){if(c(this,se))for(let t=c(this,ue);!(!N(this,A,hn).call(this,t)||((n||!c(this,ve).call(this,t))&&(yield t),t===c(this,ie)));)t=c(this,pe)[t]},hn=function(n){return n!==void 0&&c(this,te).get(c(this,Z)[n])===n},Dt=function(n){var i,a;const t=c(this,ue),s=c(this,Z)[t],r=c(this,I)[t];return c(this,Ze)&&N(this,A,Y).call(this,r)?r.__abortController.abort(new Error("evicted")):(c(this,$e)||c(this,ge))&&(c(this,$e)&&((i=c(this,Te))==null||i.call(this,r,s,"evict")),c(this,ge)&&((a=c(this,ae))==null||a.push([r,s,"evict"]))),c(this,Je).call(this,t),n&&(c(this,Z)[t]=void 0,c(this,I)[t]=void 0,c(this,Fe).push(t)),c(this,se)===1?($(this,ue,$(this,ie,0)),c(this,Fe).length=0):$(this,ue,c(this,pe)[t]),c(this,te).delete(s),Rt(this,se)._--,t},Ot=function(n,t,s,r){const i=t===void 0?void 0:c(this,I)[t];if(N(this,A,Y).call(this,i))return i;const a=new qt,{signal:o}=s;o==null||o.addEventListener("abort",()=>a.abort(o.reason),{signal:a.signal});const l={signal:a.signal,options:s,context:r},f=(T,k=!1)=>{const{aborted:m}=a.signal,u=s.ignoreFetchAbort&&T!==void 0;if(s.status&&(m&&!k?(s.status.fetchAborted=!0,s.status.fetchError=a.signal.reason,u&&(s.status.fetchAbortIgnored=!0)):s.status.fetchResolved=!0),m&&!u&&!k)return v(a.signal.reason);const h=S;return c(this,I)[t]===S&&(T===void 0?h.__staleWhileFetching?c(this,I)[t]=h.__staleWhileFetching:N(this,A,Ye).call(this,n,"fetch"):(s.status&&(s.status.fetchUpdated=!0),this.set(n,T,l.options))),T},w=T=>(s.status&&(s.status.fetchRejected=!0,s.status.fetchError=T),v(T)),v=T=>{const{aborted:k}=a.signal,m=k&&s.allowStaleOnFetchAbort,u=m||s.allowStaleOnFetchRejection,h=u||s.noDeleteOnFetchRejection,p=S;if(c(this,I)[t]===S&&(!h||p.__staleWhileFetching===void 0?N(this,A,Ye).call(this,n,"fetch"):m||(c(this,I)[t]=p.__staleWhileFetching)),u)return s.status&&p.__staleWhileFetching!==void 0&&(s.status.returnedStale=!0),p.__staleWhileFetching;if(p.__returned===p)throw T},b=(T,k)=>{var u;const m=(u=c(this,ut))==null?void 0:u.call(this,n,i,l);m&&m instanceof Promise&&m.then(h=>T(h===void 0?void 0:h),k),a.signal.addEventListener("abort",()=>{(!s.ignoreFetchAbort||s.allowStaleOnFetchAbort)&&(T(void 0),s.allowStaleOnFetchAbort&&(T=h=>f(h,!0)))})};s.status&&(s.status.fetchDispatched=!0);const S=new Promise(b).then(f,w),E=Object.assign(S,{__abortController:a,__staleWhileFetching:i,__returned:void 0});return t===void 0?(this.set(n,E,{...l.options,status:void 0}),t=c(this,te).get(n)):c(this,I)[t]=E,E},Y=function(n){if(!c(this,Ze))return!1;const t=n;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof qt},fn=function(n,t){c(this,xe)[t]=n,c(this,pe)[n]=t},yt=function(n){n!==c(this,ie)&&(n===c(this,ue)?$(this,ue,c(this,pe)[n]):N(this,A,fn).call(this,c(this,xe)[n],c(this,pe)[n]),N(this,A,fn).call(this,c(this,ie),n),$(this,ie,n))},Ye=function(n,t){var r,i,a,o;let s=!1;if(c(this,se)!==0){const l=c(this,te).get(n);if(l!==void 0)if(s=!0,c(this,se)===1)N(this,A,pn).call(this,t);else{c(this,Je).call(this,l);const f=c(this,I)[l];if(N(this,A,Y).call(this,f)?f.__abortController.abort(new Error("deleted")):(c(this,$e)||c(this,ge))&&(c(this,$e)&&((r=c(this,Te))==null||r.call(this,f,n,t)),c(this,ge)&&((i=c(this,ae))==null||i.push([f,n,t]))),c(this,te).delete(n),c(this,Z)[l]=void 0,c(this,I)[l]=void 0,l===c(this,ie))$(this,ie,c(this,xe)[l]);else if(l===c(this,ue))$(this,ue,c(this,pe)[l]);else{const w=c(this,xe)[l];c(this,pe)[w]=c(this,pe)[l];const v=c(this,pe)[l];c(this,xe)[v]=c(this,xe)[l]}Rt(this,se)._--,c(this,Fe).push(l)}}if(c(this,ge)&&((a=c(this,ae))!=null&&a.length)){const l=c(this,ae);let f;for(;f=l==null?void 0:l.shift();)(o=c(this,Ce))==null||o.call(this,...f)}return s},pn=function(n){var t,s,r;for(const i of N(this,A,He).call(this,{allowStale:!0})){const a=c(this,I)[i];if(N(this,A,Y).call(this,a))a.__abortController.abort(new Error("deleted"));else{const o=c(this,Z)[i];c(this,$e)&&((t=c(this,Te))==null||t.call(this,a,o,n)),c(this,ge)&&((s=c(this,ae))==null||s.push([a,o,n]))}}if(c(this,te).clear(),c(this,I).fill(void 0),c(this,Z).fill(void 0),c(this,we)&&c(this,je)&&(c(this,we).fill(0),c(this,je).fill(0)),c(this,Re)&&c(this,Re).fill(0),$(this,ue,0),$(this,ie,0),c(this,Fe).length=0,$(this,Ne,0),$(this,se,0),c(this,ge)&&c(this,ae)){const i=c(this,ae);let a;for(;a=i==null?void 0:i.shift();)(r=c(this,Ce))==null||r.call(this,...a)}};let un=Nn;const pi=new Ts("AIzaSyAjiPCuBtp8NW06-MFpaM4ZOWJs6WGoR7Y"),gi=[{category:ot.HARM_CATEGORY_HARASSMENT,threshold:lt.BLOCK_MEDIUM_AND_ABOVE},{category:ot.HARM_CATEGORY_HATE_SPEECH,threshold:lt.BLOCK_MEDIUM_AND_ABOVE},{category:ot.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:lt.BLOCK_MEDIUM_AND_ABOVE},{category:ot.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:lt.BLOCK_MEDIUM_AND_ABOVE}],Bn=new un({max:100,ttl:1e3*60*60}),X={maxRequestsPerMinute:60,requestCount:0,lastReset:Date.now(),backoffTime:1e3,maxBackoffTime:32e3,cooldownUntil:0};setInterval(()=>{Date.now()>=X.cooldownUntil&&(X.requestCount=0,X.lastReset=Date.now(),X.backoffTime=1e3)},6e4);const gn=async()=>{if(Date.now()<X.cooldownUntil){const e=X.cooldownUntil-Date.now();return await new Promise(n=>setTimeout(n,e)),gn()}if(Date.now()-X.lastReset>=6e4&&(X.requestCount=0,X.lastReset=Date.now(),X.backoffTime=1e3),X.requestCount>=X.maxRequestsPerMinute)return await new Promise(e=>setTimeout(e,X.backoffTime)),X.backoffTime=Math.min(X.backoffTime*2,X.maxBackoffTime),gn();X.requestCount++},mi=(e,n,t)=>`${e}:${n}:${t.map(s=>`${s.role}:${s.content}`).join("|")}`,yi=e=>e.length<=4?e.map(n=>`${n.role}: ${n.content}`).join(`
`):[e[0],{role:"system",content:`[Previous conversation summarized: ${e.length-4} messages omitted]`},...e.slice(-3)].map(n=>`${n.role}: ${n.content}`).join(`
`),bi=ft((e,n)=>({messages:[],isLoading:!1,error:null,storeChat:!0,setStoreChat:async t=>{const s=ee.getState().session,r=(await M.auth.getUser()).data.user;if(!(!s||!r))try{const{data:i}=await M.rpc("get_or_create_user_chat",{p_user_id:r.id,p_session_id:s.id,p_store_chat:t});i&&e({storeChat:t})}catch(i){console.error("Failed to update chat storage preference:",i)}},sendMessage:async t=>{var i,a,o;const s=ee.getState().session,r=(await M.auth.getUser()).data.user;if(!(!s||!r)){e({isLoading:!0,error:null});try{const{data:l}=await M.rpc("get_or_create_user_chat",{p_user_id:r.id,p_session_id:s.id,p_store_chat:n().storeChat});if(!l)throw new Error("Failed to create chat");const f={id:crypto.randomUUID(),role:"user",content:t,created_at:new Date().toISOString()};e({messages:[...n().messages,f]}),n().storeChat&&await M.from("user_ai_messages").insert({chat_id:l,role:"user",content:t});const w=`
        Session: ${s.title}
        Description: ${s.description||"No description provided"}
        Status: ${s.status}
        Current Time: ${new Date().toLocaleString()}
      `,v=mi(r.id,s.id,n().messages),b=Bn.get(v);if(b){const u={id:crypto.randomUUID(),role:"assistant",content:b,created_at:new Date().toISOString()};e({messages:[...n().messages,u]}),n().storeChat&&await M.from("user_ai_messages").insert({chat_id:l,role:"assistant",content:b});return}await gn();const S=crypto.randomUUID();let E="";e({messages:[...n().messages,{id:S,role:"assistant",content:"",created_at:new Date().toISOString()}]});const T=pi.getGenerativeModel({model:"gemini-1.5-pro-002",safetySettings:gi,generationConfig:{maxOutputTokens:2e3,temperature:.7,topK:40,topP:.95}}),k=yi(n().messages),m=Date.now();try{E=(await(await T.generateContent([{text:`You are an AI teaching assistant for a class session. Here's the context:
${w}

Respond to student questions with clear, concise answers. Use markdown formatting when appropriate.`},{text:"I understand. I'll help students with their questions about the class session, providing clear explanations and using markdown formatting when it helps clarify the content."},{text:k},{text:t}])).response).text(),e({messages:n().messages.map(g=>g.id===S?{...g,content:E}:g)}),n().storeChat&&await M.from("user_ai_messages").insert({chat_id:l,role:"assistant",content:E});const p=Date.now()-m;Bn.set(v,E)}catch(u){throw(i=u.message)!=null&&i.includes("quota")?new Error("API quota exceeded. Please try again later."):(a=u.message)!=null&&a.includes("blocked")?new Error("Response was blocked by safety settings. Please rephrase your question."):(o=u.message)!=null&&o.includes("model not found")?new Error("The AI model is temporarily unavailable. Please try again later."):(console.error("Gemini API Error:",u),new Error("Failed to get AI response. Please try again."))}}catch(l){let f="Failed to get AI response. Please try again.";l!=null&&l.message&&(f=l.message),e({error:f}),X.requestCount=X.maxRequestsPerMinute,X.backoffTime=Math.min(X.backoffTime*2,X.maxBackoffTime)}finally{e({isLoading:!1})}}},loadMessages:async()=>{const t=ee.getState().session,s=(await M.auth.getUser()).data.user;if(!(!t||!s)){e({isLoading:!0,error:null});try{const{data:r}=await M.from("user_ai_chats").select("id, store_chat").eq("user_id",s.id).eq("session_id",t.id).single();if(r){e({storeChat:r.store_chat});const{data:i}=await M.from("user_ai_messages").select("*").eq("chat_id",r.id).order("created_at",{ascending:!0});i&&e({messages:i.map(a=>({id:a.id,role:a.role,content:a.content,created_at:a.created_at}))})}else e({messages:[],storeChat:!0})}catch(r){e({error:r.message})}finally{e({isLoading:!1})}}},clearMessages:()=>{e({messages:[],error:null})}}));var xi=(e,n,t)=>{if(!n.has(e))throw TypeError("Cannot "+t)},Wn=(e,n,t)=>{if(n.has(e))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(e):n.set(e,t)},mn=(e,n,t)=>(xi(e,n,"access private method"),t);function kn(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}var nt=kn();function js(e){nt=e}var $s=/[&<>"']/,wi=new RegExp($s.source,"g"),Ms=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,vi=new RegExp(Ms.source,"g"),_i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Gn=e=>_i[e];function de(e,n){if(n){if($s.test(e))return e.replace(wi,Gn)}else if(Ms.test(e))return e.replace(vi,Gn);return e}var ki=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Ds(e){return e.replace(ki,(n,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}var Si=/(^|[^\[])\^/g;function q(e,n){e=typeof e=="string"?e:e.source,n=n||"";const t={replace:(s,r)=>(r=typeof r=="object"&&"source"in r?r.source:r,r=r.replace(Si,"$1"),e=e.replace(s,r),t),getRegex:()=>new RegExp(e,n)};return t}var Ei=/[^\w:]/g,Ai=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Hn(e,n,t){if(e){let s;try{s=decodeURIComponent(Ds(t)).replace(Ei,"").toLowerCase()}catch{return null}if(s.indexOf("javascript:")===0||s.indexOf("vbscript:")===0||s.indexOf("data:")===0)return null}n&&!Ai.test(t)&&(t=Fi(n,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}var $t={},Ti=/^[^:]+:\/*[^/]*$/,Ci=/^([^:]+:)[\s\S]*$/,Ni=/^([^:]+:\/*[^/]*)[\s\S]*$/;function Fi(e,n){$t[" "+e]||(Ti.test(e)?$t[" "+e]=e+"/":$t[" "+e]=It(e,"/",!0)),e=$t[" "+e];const t=e.indexOf(":")===-1;return n.substring(0,2)==="//"?t?n:e.replace(Ci,"$1")+n:n.charAt(0)==="/"?t?n:e.replace(Ni,"$1")+n:e+n}var Bt={exec:()=>null};function Yn(e,n){const t=e.replace(/\|/g,(i,a,o)=>{let l=!1,f=a;for(;--f>=0&&o[f]==="\\";)l=!l;return l?"|":" |"}),s=t.split(/ \|/);let r=0;if(s[0].trim()||s.shift(),s.length>0&&!s[s.length-1].trim()&&s.pop(),s.length>n)s.splice(n);else for(;s.length<n;)s.push("");for(;r<s.length;r++)s[r]=s[r].trim().replace(/\\\|/g,"|");return s}function It(e,n,t){const s=e.length;if(s===0)return"";let r=0;for(;r<s;){const i=e.charAt(s-r-1);if(i===n&&!t)r++;else if(i!==n&&t)r++;else break}return e.slice(0,s-r)}function Ri(e,n){if(e.indexOf(n[1])===-1)return-1;const t=e.length;let s=0,r=0;for(;r<t;r++)if(e[r]==="\\")r++;else if(e[r]===n[0])s++;else if(e[r]===n[1]&&(s--,s<0))return r;return-1}function ji(e,n){!e||e.silent||(n&&console.warn("marked(): callback is deprecated since version 5.0.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/using_pro#async"),(e.sanitize||e.sanitizer)&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options"),(e.highlight||e.langPrefix!=="language-")&&console.warn("marked(): highlight and langPrefix parameters are deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-highlight."),e.mangle&&console.warn("marked(): mangle parameter is enabled by default, but is deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install https://www.npmjs.com/package/marked-mangle, or disable by setting `{mangle: false}`."),e.baseUrl&&console.warn("marked(): baseUrl parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-base-url."),e.smartypants&&console.warn("marked(): smartypants parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-smartypants."),e.xhtml&&console.warn("marked(): xhtml parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-xhtml."),(e.headerIds||e.headerPrefix)&&console.warn("marked(): headerIds and headerPrefix parameters enabled by default, but are deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install  https://www.npmjs.com/package/marked-gfm-heading-id, or disable by setting `{headerIds: false}`."))}function Zn(e,n,t,s){const r=n.href,i=n.title?de(n.title):null,a=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){s.state.inLink=!0;const o={type:"link",raw:t,href:r,title:i,text:a,tokens:s.inlineTokens(a)};return s.state.inLink=!1,o}return{type:"image",raw:t,href:r,title:i,text:de(a)}}function $i(e,n){const t=e.match(/^(\s+)(?:```)/);if(t===null)return n;const s=t[1];return n.split(`
`).map(r=>{const i=r.match(/^\s+/);if(i===null)return r;const[a]=i;return a.length>=s.length?r.slice(s.length):r}).join(`
`)}var Wt=class{constructor(e){this.options=e||nt}space(e){const n=this.rules.block.newline.exec(e);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(e){const n=this.rules.block.code.exec(e);if(n){const t=n[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?t:It(t,`
`)}}}fences(e){const n=this.rules.block.fences.exec(e);if(n){const t=n[0],s=$i(t,n[3]||"");return{type:"code",raw:t,lang:n[2]?n[2].trim().replace(this.rules.inline._escapes,"$1"):n[2],text:s}}}heading(e){const n=this.rules.block.heading.exec(e);if(n){let t=n[2].trim();if(/#$/.test(t)){const s=It(t,"#");(this.options.pedantic||!s||/ $/.test(s))&&(t=s.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(e){const n=this.rules.block.hr.exec(e);if(n)return{type:"hr",raw:n[0]}}blockquote(e){const n=this.rules.block.blockquote.exec(e);if(n){const t=n[0].replace(/^ *>[ \t]?/gm,""),s=this.lexer.state.top;this.lexer.state.top=!0;const r=this.lexer.blockTokens(t);return this.lexer.state.top=s,{type:"blockquote",raw:n[0],tokens:r,text:t}}}list(e){let n=this.rules.block.list.exec(e);if(n){let t,s,r,i,a,o,l,f,w,v,b,S,E=n[1].trim();const T=E.length>1,k={type:"list",raw:"",ordered:T,start:T?+E.slice(0,-1):"",loose:!1,items:[]};E=T?`\\d{1,9}\\${E.slice(-1)}`:`\\${E}`,this.options.pedantic&&(E=T?E:"[*+-]");const m=new RegExp(`^( {0,3}${E})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;e&&(S=!1,!(!(n=m.exec(e))||this.rules.block.hr.test(e)));){if(t=n[0],e=e.substring(t.length),f=n[2].split(`
`,1)[0].replace(/^\t+/,h=>" ".repeat(3*h.length)),w=e.split(`
`,1)[0],this.options.pedantic?(i=2,b=f.trimLeft()):(i=n[2].search(/[^ ]/),i=i>4?1:i,b=f.slice(i),i+=n[1].length),o=!1,!f&&/^ *$/.test(w)&&(t+=w+`
`,e=e.substring(w.length+1),S=!0),!S){const h=new RegExp(`^ {0,${Math.min(3,i-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),p=new RegExp(`^ {0,${Math.min(3,i-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),g=new RegExp(`^ {0,${Math.min(3,i-1)}}(?:\`\`\`|~~~)`),x=new RegExp(`^ {0,${Math.min(3,i-1)}}#`);for(;e&&(v=e.split(`
`,1)[0],w=v,this.options.pedantic&&(w=w.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(g.test(w)||x.test(w)||h.test(w)||p.test(e)));){if(w.search(/[^ ]/)>=i||!w.trim())b+=`
`+w.slice(i);else{if(o||f.search(/[^ ]/)>=4||g.test(f)||x.test(f)||p.test(f))break;b+=`
`+w}!o&&!w.trim()&&(o=!0),t+=v+`
`,e=e.substring(v.length+1),f=w.slice(i)}}k.loose||(l?k.loose=!0:/\n *\n *$/.test(t)&&(l=!0)),this.options.gfm&&(s=/^\[[ xX]\] /.exec(b),s&&(r=s[0]!=="[ ] ",b=b.replace(/^\[[ xX]\] +/,""))),k.items.push({type:"list_item",raw:t,task:!!s,checked:r,loose:!1,text:b}),k.raw+=t}k.items[k.items.length-1].raw=t.trimRight(),k.items[k.items.length-1].text=b.trimRight(),k.raw=k.raw.trimRight();const u=k.items.length;for(a=0;a<u;a++)if(this.lexer.state.top=!1,k.items[a].tokens=this.lexer.blockTokens(k.items[a].text,[]),!k.loose){const h=k.items[a].tokens.filter(g=>g.type==="space"),p=h.length>0&&h.some(g=>/\n.*\n/.test(g.raw));k.loose=p}if(k.loose)for(a=0;a<u;a++)k.items[a].loose=!0;return k}}html(e){const n=this.rules.block.html.exec(e);if(n){const t={type:"html",block:!0,raw:n[0],pre:!this.options.sanitizer&&(n[1]==="pre"||n[1]==="script"||n[1]==="style"),text:n[0]};if(this.options.sanitize){const s=this.options.sanitizer?this.options.sanitizer(n[0]):de(n[0]),r=t;r.type="paragraph",r.text=s,r.tokens=this.lexer.inline(s)}return t}}def(e){const n=this.rules.block.def.exec(e);if(n){const t=n[1].toLowerCase().replace(/\s+/g," "),s=n[2]?n[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",r=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline._escapes,"$1"):n[3];return{type:"def",tag:t,raw:n[0],href:s,title:r}}}table(e){const n=this.rules.block.table.exec(e);if(n){const t={type:"table",header:Yn(n[1]).map(s=>({text:s})),align:n[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:n[3]&&n[3].trim()?n[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(t.header.length===t.align.length){t.raw=n[0];let s=t.align.length,r,i,a,o;for(r=0;r<s;r++)/^ *-+: *$/.test(t.align[r])?t.align[r]="right":/^ *:-+: *$/.test(t.align[r])?t.align[r]="center":/^ *:-+ *$/.test(t.align[r])?t.align[r]="left":t.align[r]=null;for(s=t.rows.length,r=0;r<s;r++)t.rows[r]=Yn(t.rows[r],t.header.length).map(l=>({text:l}));for(s=t.header.length,i=0;i<s;i++)t.header[i].tokens=this.lexer.inline(t.header[i].text);for(s=t.rows.length,i=0;i<s;i++)for(o=t.rows[i],a=0;a<o.length;a++)o[a].tokens=this.lexer.inline(o[a].text);return t}}}lheading(e){const n=this.rules.block.lheading.exec(e);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(e){const n=this.rules.block.paragraph.exec(e);if(n){const t=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:t,tokens:this.lexer.inline(t)}}}text(e){const n=this.rules.block.text.exec(e);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(e){const n=this.rules.inline.escape.exec(e);if(n)return{type:"escape",raw:n[0],text:de(n[1])}}tag(e){const n=this.rules.inline.tag.exec(e);if(n)return!this.lexer.state.inLink&&/^<a /i.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):de(n[0]):n[0]}}link(e){const n=this.rules.inline.link.exec(e);if(n){const t=n[2].trim();if(!this.options.pedantic&&/^</.test(t)){if(!/>$/.test(t))return;const i=It(t.slice(0,-1),"\\");if((t.length-i.length)%2===0)return}else{const i=Ri(n[2],"()");if(i>-1){const o=(n[0].indexOf("!")===0?5:4)+n[1].length+i;n[2]=n[2].substring(0,i),n[0]=n[0].substring(0,o).trim(),n[3]=""}}let s=n[2],r="";if(this.options.pedantic){const i=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);i&&(s=i[1],r=i[3])}else r=n[3]?n[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(t)?s=s.slice(1):s=s.slice(1,-1)),Zn(n,{href:s&&s.replace(this.rules.inline._escapes,"$1"),title:r&&r.replace(this.rules.inline._escapes,"$1")},n[0],this.lexer)}}reflink(e,n){let t;if((t=this.rules.inline.reflink.exec(e))||(t=this.rules.inline.nolink.exec(e))){let s=(t[2]||t[1]).replace(/\s+/g," ");if(s=n[s.toLowerCase()],!s){const r=t[0].charAt(0);return{type:"text",raw:r,text:r}}return Zn(t,s,t[0],this.lexer)}}emStrong(e,n,t=""){let s=this.rules.inline.emStrong.lDelim.exec(e);if(!s||s[3]&&t.match(/[\p{L}\p{N}]/u))return;if(!(s[1]||s[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const i=s[0].length-1;let a,o,l=i,f=0;const w=s[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(w.lastIndex=0,n=n.slice(-1*e.length+i);(s=w.exec(n))!=null;){if(a=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!a)continue;if(o=a.length,s[3]||s[4]){l+=o;continue}else if((s[5]||s[6])&&i%3&&!((i+o)%3)){f+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+f);const v=e.slice(0,i+s.index+o+1);if(Math.min(i,o)%2){const S=v.slice(1,-1);return{type:"em",raw:v,text:S,tokens:this.lexer.inlineTokens(S)}}const b=v.slice(2,-2);return{type:"strong",raw:v,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(e){const n=this.rules.inline.code.exec(e);if(n){let t=n[2].replace(/\n/g," ");const s=/[^ ]/.test(t),r=/^ /.test(t)&&/ $/.test(t);return s&&r&&(t=t.substring(1,t.length-1)),t=de(t,!0),{type:"codespan",raw:n[0],text:t}}}br(e){const n=this.rules.inline.br.exec(e);if(n)return{type:"br",raw:n[0]}}del(e){const n=this.rules.inline.del.exec(e);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(e,n){const t=this.rules.inline.autolink.exec(e);if(t){let s,r;return t[2]==="@"?(s=de(this.options.mangle?n(t[1]):t[1]),r="mailto:"+s):(s=de(t[1]),r=s),{type:"link",raw:t[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}url(e,n){let t;if(t=this.rules.inline.url.exec(e)){let s,r;if(t[2]==="@")s=de(this.options.mangle?n(t[0]):t[0]),r="mailto:"+s;else{let i;do i=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])[0];while(i!==t[0]);s=de(t[0]),t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(e,n){const t=this.rules.inline.text.exec(e);if(t){let s;return this.lexer.state.inRawBlock?s=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):de(t[0]):t[0]:s=de(this.options.smartypants?n(t[0]):t[0]),{type:"text",raw:t[0],text:s}}}},j={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Bt,lheading:/^((?:(?!^bull ).|\n(?!\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};j._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;j._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;j.def=q(j.def).replace("label",j._label).replace("title",j._title).getRegex();j.bullet=/(?:[*+-]|\d{1,9}[.)])/;j.listItemStart=q(/^( *)(bull) */).replace("bull",j.bullet).getRegex();j.list=q(j.list).replace(/bull/g,j.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+j.def.source+")").getRegex();j._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";j._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;j.html=q(j.html,"i").replace("comment",j._comment).replace("tag",j._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();j.lheading=q(j.lheading).replace(/bull/g,j.bullet).getRegex();j.paragraph=q(j._paragraph).replace("hr",j.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j._tag).getRegex();j.blockquote=q(j.blockquote).replace("paragraph",j.paragraph).getRegex();j.normal={...j};j.gfm={...j.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};j.gfm.table=q(j.gfm.table).replace("hr",j.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j._tag).getRegex();j.gfm.paragraph=q(j._paragraph).replace("hr",j.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",j.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j._tag).getRegex();j.pedantic={...j.normal,html:q(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",j._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Bt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:q(j.normal._paragraph).replace("hr",j.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",j.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};var C={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Bt,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Bt,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};C._punctuation="\\p{P}$+<=>`^|~";C.punctuation=q(C.punctuation,"u").replace(/punctuation/g,C._punctuation).getRegex();C.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;C.anyPunctuation=/\\[punct]/g;C._escapes=/\\([punct])/g;C._comment=q(j._comment).replace("(?:-->|$)","-->").getRegex();C.emStrong.lDelim=q(C.emStrong.lDelim,"u").replace(/punct/g,C._punctuation).getRegex();C.emStrong.rDelimAst=q(C.emStrong.rDelimAst,"gu").replace(/punct/g,C._punctuation).getRegex();C.emStrong.rDelimUnd=q(C.emStrong.rDelimUnd,"gu").replace(/punct/g,C._punctuation).getRegex();C.anyPunctuation=q(C.anyPunctuation,"gu").replace(/punct/g,C._punctuation).getRegex();C._escapes=q(C._escapes,"gu").replace(/punct/g,C._punctuation).getRegex();C._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;C._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;C.autolink=q(C.autolink).replace("scheme",C._scheme).replace("email",C._email).getRegex();C._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;C.tag=q(C.tag).replace("comment",C._comment).replace("attribute",C._attribute).getRegex();C._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;C._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;C._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;C.link=q(C.link).replace("label",C._label).replace("href",C._href).replace("title",C._title).getRegex();C.reflink=q(C.reflink).replace("label",C._label).replace("ref",j._label).getRegex();C.nolink=q(C.nolink).replace("ref",j._label).getRegex();C.reflinkSearch=q(C.reflinkSearch,"g").replace("reflink",C.reflink).replace("nolink",C.nolink).getRegex();C.normal={...C};C.pedantic={...C.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:q(/^!?\[(label)\]\((.*?)\)/).replace("label",C._label).getRegex(),reflink:q(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",C._label).getRegex()};C.gfm={...C.normal,escape:q(C.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};C.gfm.url=q(C.gfm.url,"i").replace("email",C.gfm._extended_email).getRegex();C.breaks={...C.gfm,br:q(C.br).replace("{2,}","*").getRegex(),text:q(C.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function Mi(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function Kn(e){let n="",t,s;const r=e.length;for(t=0;t<r;t++)s=e.charCodeAt(t),Math.random()>.5&&(s="x"+s.toString(16)),n+="&#"+s+";";return n}var ze=class{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||nt,this.options.tokenizer=this.options.tokenizer||new Wt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={block:j.normal,inline:C.normal};this.options.pedantic?(n.block=j.pedantic,n.inline=C.pedantic):this.options.gfm&&(n.block=j.gfm,this.options.breaks?n.inline=C.breaks:n.inline=C.gfm),this.tokenizer.rules=n}static get rules(){return{block:j,inline:C}}static lex(e,n){return new ze(n).lex(e)}static lexInline(e,n){return new ze(n).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let n;for(;n=this.inlineQueue.shift();)this.inlineTokens(n.src,n.tokens);return this.tokens}blockTokens(e,n=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,o,l)=>o+"    ".repeat(l.length));let t,s,r,i;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(t=a.call({lexer:this},e,n))?(e=e.substring(t.raw.length),n.push(t),!0):!1))){if(t=this.tokenizer.space(e)){e=e.substring(t.raw.length),t.raw.length===1&&n.length>0?n[n.length-1].raw+=`
`:n.push(t);continue}if(t=this.tokenizer.code(e)){e=e.substring(t.raw.length),s=n[n.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+t.raw,s.text+=`
`+t.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):n.push(t);continue}if(t=this.tokenizer.fences(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.heading(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.hr(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.blockquote(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.list(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.html(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.def(e)){e=e.substring(t.raw.length),s=n[n.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+t.raw,s.text+=`
`+t.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[t.tag]||(this.tokens.links[t.tag]={href:t.href,title:t.title});continue}if(t=this.tokenizer.table(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.lheading(e)){e=e.substring(t.raw.length),n.push(t);continue}if(r=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const o=e.slice(1);let l;this.options.extensions.startBlock.forEach(f=>{l=f.call({lexer:this},o),typeof l=="number"&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(r=e.substring(0,a+1))}if(this.state.top&&(t=this.tokenizer.paragraph(r))){s=n[n.length-1],i&&s.type==="paragraph"?(s.raw+=`
`+t.raw,s.text+=`
`+t.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):n.push(t),i=r.length!==e.length,e=e.substring(t.raw.length);continue}if(t=this.tokenizer.text(e)){e=e.substring(t.raw.length),s=n[n.length-1],s&&s.type==="text"?(s.raw+=`
`+t.raw,s.text+=`
`+t.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):n.push(t);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){let t,s,r,i=e,a,o,l;if(this.tokens.links){const f=Object.keys(this.tokens.links);if(f.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)f.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,a.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(o||(l=""),o=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(f=>(t=f.call({lexer:this},e,n))?(e=e.substring(t.raw.length),n.push(t),!0):!1))){if(t=this.tokenizer.escape(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.tag(e)){e=e.substring(t.raw.length),s=n[n.length-1],s&&t.type==="text"&&s.type==="text"?(s.raw+=t.raw,s.text+=t.text):n.push(t);continue}if(t=this.tokenizer.link(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(t.raw.length),s=n[n.length-1],s&&t.type==="text"&&s.type==="text"?(s.raw+=t.raw,s.text+=t.text):n.push(t);continue}if(t=this.tokenizer.emStrong(e,i,l)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.codespan(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.br(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.del(e)){e=e.substring(t.raw.length),n.push(t);continue}if(t=this.tokenizer.autolink(e,Kn)){e=e.substring(t.raw.length),n.push(t);continue}if(!this.state.inLink&&(t=this.tokenizer.url(e,Kn))){e=e.substring(t.raw.length),n.push(t);continue}if(r=e,this.options.extensions&&this.options.extensions.startInline){let f=1/0;const w=e.slice(1);let v;this.options.extensions.startInline.forEach(b=>{v=b.call({lexer:this},w),typeof v=="number"&&v>=0&&(f=Math.min(f,v))}),f<1/0&&f>=0&&(r=e.substring(0,f+1))}if(t=this.tokenizer.inlineText(r,Mi)){e=e.substring(t.raw.length),t.raw.slice(-1)!=="_"&&(l=t.raw.slice(-1)),o=!0,s=n[n.length-1],s&&s.type==="text"?(s.raw+=t.raw,s.text+=t.text):n.push(t);continue}if(e){const f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return n}},Gt=class{constructor(e){this.options=e||nt}code(e,n,t){const s=(n||"").match(/\S*/)[0];if(this.options.highlight){const r=this.options.highlight(e,s);r!=null&&r!==e&&(t=!0,e=r)}return e=e.replace(/\n$/,"")+`
`,s?'<pre><code class="'+this.options.langPrefix+de(s)+'">'+(t?e:de(e,!0))+`</code></pre>
`:"<pre><code>"+(t?e:de(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,n){return e}heading(e,n,t,s){if(this.options.headerIds){const r=this.options.headerPrefix+s.slug(t);return`<h${n} id="${r}">${e}</h${n}>
`}return`<h${n}>${e}</h${n}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,n,t){const s=n?"ol":"ul",r=n&&t!==1?' start="'+t+'"':"";return"<"+s+r+`>
`+e+"</"+s+`>
`}listitem(e,n,t){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return`<p>${e}</p>
`}table(e,n){return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+n+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,n){const t=n.header?"th":"td";return(n.align?`<${t} align="${n.align}">`:`<${t}>`)+e+`</${t}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return`<del>${e}</del>`}link(e,n,t){if(e=Hn(this.options.sanitize,this.options.baseUrl,e),e===null)return t;let s='<a href="'+e+'"';return n&&(s+=' title="'+n+'"'),s+=">"+t+"</a>",s}image(e,n,t){if(e=Hn(this.options.sanitize,this.options.baseUrl,e),e===null)return t;let s=`<img src="${e}" alt="${t}"`;return n&&(s+=` title="${n}"`),s+=this.options.xhtml?"/>":">",s}text(e){return e}},Sn=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,n,t){return""+t}image(e,n,t){return""+t}br(){return""}},En=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,n){let t=e,s=0;if(this.seen.hasOwnProperty(t)){s=this.seen[e];do s++,t=e+"-"+s;while(this.seen.hasOwnProperty(t))}return n||(this.seen[e]=s,this.seen[t]=0),t}slug(e,n={}){const t=this.serialize(e);return this.getNextSafeSlug(t,n.dryrun)}},Pe=class{constructor(e){this.options=e||nt,this.options.renderer=this.options.renderer||new Gt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Sn,this.slugger=new En}static parse(e,n){return new Pe(n).parse(e)}static parseInline(e,n){return new Pe(n).parseInline(e)}parse(e,n=!0){let t="",s,r,i,a,o,l,f,w,v,b,S,E,T,k,m,u,h,p,g;const x=e.length;for(s=0;s<x;s++){if(b=e[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[b.type]&&(g=this.options.extensions.renderers[b.type].call({parser:this},b),g!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(b.type))){t+=g||"";continue}switch(b.type){case"space":continue;case"hr":{t+=this.renderer.hr();continue}case"heading":{t+=this.renderer.heading(this.parseInline(b.tokens),b.depth,Ds(this.parseInline(b.tokens,this.textRenderer)),this.slugger);continue}case"code":{t+=this.renderer.code(b.text,b.lang,!!b.escaped);continue}case"table":{for(w="",f="",a=b.header.length,r=0;r<a;r++)f+=this.renderer.tablecell(this.parseInline(b.header[r].tokens),{header:!0,align:b.align[r]});for(w+=this.renderer.tablerow(f),v="",a=b.rows.length,r=0;r<a;r++){for(l=b.rows[r],f="",o=l.length,i=0;i<o;i++)f+=this.renderer.tablecell(this.parseInline(l[i].tokens),{header:!1,align:b.align[i]});v+=this.renderer.tablerow(f)}t+=this.renderer.table(w,v);continue}case"blockquote":{v=this.parse(b.tokens),t+=this.renderer.blockquote(v);continue}case"list":{for(S=b.ordered,E=b.start,T=b.loose,a=b.items.length,v="",r=0;r<a;r++)m=b.items[r],u=m.checked,h=m.task,k="",m.task&&(p=this.renderer.checkbox(!!u),T?m.tokens.length>0&&m.tokens[0].type==="paragraph"?(m.tokens[0].text=p+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&m.tokens[0].tokens[0].type==="text"&&(m.tokens[0].tokens[0].text=p+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:p}):k+=p),k+=this.parse(m.tokens,T),v+=this.renderer.listitem(k,h,!!u);t+=this.renderer.list(v,S,E);continue}case"html":{t+=this.renderer.html(b.text,b.block);continue}case"paragraph":{t+=this.renderer.paragraph(this.parseInline(b.tokens));continue}case"text":{for(v=b.tokens?this.parseInline(b.tokens):b.text;s+1<x&&e[s+1].type==="text";)b=e[++s],v+=`
`+(b.tokens?this.parseInline(b.tokens):b.text);t+=n?this.renderer.paragraph(v):v;continue}default:{const _='Token with "'+b.type+'" type was not found.';if(this.options.silent)return console.error(_),"";throw new Error(_)}}}return t}parseInline(e,n){n=n||this.renderer;let t="",s,r,i;const a=e.length;for(s=0;s<a;s++){if(r=e[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]&&(i=this.options.extensions.renderers[r.type].call({parser:this},r),i!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type))){t+=i||"";continue}switch(r.type){case"escape":{t+=n.text(r.text);break}case"html":{t+=n.html(r.text);break}case"link":{t+=n.link(r.href,r.title,this.parseInline(r.tokens,n));break}case"image":{t+=n.image(r.href,r.title,r.text);break}case"strong":{t+=n.strong(this.parseInline(r.tokens,n));break}case"em":{t+=n.em(this.parseInline(r.tokens,n));break}case"codespan":{t+=n.codespan(r.text);break}case"br":{t+=n.br();break}case"del":{t+=n.del(this.parseInline(r.tokens,n));break}case"text":{t+=n.text(r.text);break}default:{const o='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return t}},xt=class{constructor(e){this.options=e||nt}preprocess(e){return e}postprocess(e){return e}};xt.passThroughHooks=new Set(["preprocess","postprocess"]);var zt,yn,An,Os,Is=class{constructor(...e){Wn(this,zt),Wn(this,An),this.defaults=kn(),this.options=this.setOptions,this.parse=mn(this,zt,yn).call(this,ze.lex,Pe.parse),this.parseInline=mn(this,zt,yn).call(this,ze.lexInline,Pe.parseInline),this.Parser=Pe,this.parser=Pe.parse,this.Renderer=Gt,this.TextRenderer=Sn,this.Lexer=ze,this.lexer=ze.lex,this.Tokenizer=Wt,this.Slugger=En,this.Hooks=xt,this.use(...e)}walkTokens(e,n){let t=[];for(const s of e)switch(t=t.concat(n.call(this,s)),s.type){case"table":{for(const r of s.header)t=t.concat(this.walkTokens(r.tokens,n));for(const r of s.rows)for(const i of r)t=t.concat(this.walkTokens(i.tokens,n));break}case"list":{t=t.concat(this.walkTokens(s.items,n));break}default:this.defaults.extensions&&this.defaults.extensions.childTokens&&this.defaults.extensions.childTokens[s.type]?this.defaults.extensions.childTokens[s.type].forEach(r=>{t=t.concat(this.walkTokens(s[r],n))}):s.tokens&&(t=t.concat(this.walkTokens(s.tokens,n)))}return t}use(...e){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(t=>{const s={...t};if(s.async=this.defaults.async||s.async||!1,t.extensions&&(t.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const i=n.renderers[r.name];i?n.renderers[r.name]=function(...a){let o=r.renderer.apply(this,a);return o===!1&&(o=i.apply(this,a)),o}:n.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");n[r.level]?n[r.level].unshift(r.tokenizer):n[r.level]=[r.tokenizer],r.start&&(r.level==="block"?n.startBlock?n.startBlock.push(r.start):n.startBlock=[r.start]:r.level==="inline"&&(n.startInline?n.startInline.push(r.start):n.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(n.childTokens[r.name]=r.childTokens)}),s.extensions=n),t.renderer){const r=this.defaults.renderer||new Gt(this.defaults);for(const i in t.renderer){const a=r[i];r[i]=(...o)=>{let l=t.renderer[i].apply(r,o);return l===!1&&(l=a.apply(r,o)),l}}s.renderer=r}if(t.tokenizer){const r=this.defaults.tokenizer||new Wt(this.defaults);for(const i in t.tokenizer){const a=r[i];r[i]=(...o)=>{let l=t.tokenizer[i].apply(r,o);return l===!1&&(l=a.apply(r,o)),l}}s.tokenizer=r}if(t.hooks){const r=this.defaults.hooks||new xt;for(const i in t.hooks){const a=r[i];xt.passThroughHooks.has(i)?r[i]=o=>{if(this.defaults.async)return Promise.resolve(t.hooks[i].call(r,o)).then(f=>a.call(r,f));const l=t.hooks[i].call(r,o);return a.call(r,l)}:r[i]=(...o)=>{let l=t.hooks[i].apply(r,o);return l===!1&&(l=a.apply(r,o)),l}}s.hooks=r}if(t.walkTokens){const r=this.defaults.walkTokens;s.walkTokens=function(i){let a=[];return a.push(t.walkTokens.call(this,i)),r&&(a=a.concat(r.call(this,i))),a}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}};zt=new WeakSet;yn=function(e,n){return(t,s,r)=>{typeof s=="function"&&(r=s,s=null);const i={...s},a={...this.defaults,...i},o=mn(this,An,Os).call(this,!!a.silent,!!a.async,r);if(typeof t>"u"||t===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(ji(a,r),a.hooks&&(a.hooks.options=a),r){const l=a.highlight;let f;try{a.hooks&&(t=a.hooks.preprocess(t)),f=e(t,a)}catch(b){return o(b)}const w=b=>{let S;if(!b)try{a.walkTokens&&this.walkTokens(f,a.walkTokens),S=n(f,a),a.hooks&&(S=a.hooks.postprocess(S))}catch(E){b=E}return a.highlight=l,b?o(b):r(null,S)};if(!l||l.length<3||(delete a.highlight,!f.length))return w();let v=0;this.walkTokens(f,b=>{b.type==="code"&&(v++,setTimeout(()=>{l(b.text,b.lang,(S,E)=>{if(S)return w(S);E!=null&&E!==b.text&&(b.text=E,b.escaped=!0),v--,v===0&&w()})},0))}),v===0&&w();return}if(a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(t):t).then(l=>e(l,a)).then(l=>a.walkTokens?Promise.all(this.walkTokens(l,a.walkTokens)).then(()=>l):l).then(l=>n(l,a)).then(l=>a.hooks?a.hooks.postprocess(l):l).catch(o);try{a.hooks&&(t=a.hooks.preprocess(t));const l=e(t,a);a.walkTokens&&this.walkTokens(l,a.walkTokens);let f=n(l,a);return a.hooks&&(f=a.hooks.postprocess(f)),f}catch(l){return o(l)}}};An=new WeakSet;Os=function(e,n,t){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+de(s.message+"",!0)+"</pre>";if(n)return Promise.resolve(r);if(t){t(null,r);return}return r}if(n)return Promise.reject(s);if(t){t(s);return}throw s}};var et=new Is;function B(e,n,t){return et.parse(e,n,t)}B.options=B.setOptions=function(e){return et.setOptions(e),B.defaults=et.defaults,js(B.defaults),B};B.getDefaults=kn;B.defaults=nt;B.use=function(...e){return et.use(...e),B.defaults=et.defaults,js(B.defaults),B};B.walkTokens=function(e,n){return et.walkTokens(e,n)};B.parseInline=et.parseInline;B.Parser=Pe;B.parser=Pe.parse;B.Renderer=Gt;B.TextRenderer=Sn;B.Lexer=ze;B.lexer=ze.lex;B.Tokenizer=Wt;B.Slugger=En;B.Hooks=xt;B.parse=B;B.options;B.setOptions;B.use;B.walkTokens;B.parseInline;Pe.parse;ze.lex;const Di={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},zs=/&(?:amp|lt|gt|quot|#(?:0+)?39);/g,Oi=RegExp(zs.source),Vn=(e="")=>Oi.test(e)?e.replace(zs,n=>Di[n]||"'"):e,Xn=(e,n)=>{if(!n)return e;try{return new URL(e,n).href}catch{return e}};class Ii{constructor(n){this.renderer=n.renderer}parse(n=[]){return n.map(t=>{switch(t.type){case"space":return null;case"heading":{const s=t.depth;return this.renderer.heading(this.parseInline(t.tokens),s)}case"paragraph":return this.renderer.paragraph(this.parseInline(t.tokens));case"text":{const s=t.tokens;return s?this.parseInline(s):t.text}case"blockquote":{const s=this.parse(t.tokens);return this.renderer.blockquote(s)}case"list":{const s=t.items.map(r=>{var i;const a=[];return r.task&&a.push(this.renderer.checkbox((i=r.checked)!==null&&i!==void 0?i:!1)),a.push(this.parse(r.tokens)),this.renderer.listItem(a)});return this.renderer.list(s,t.ordered)}case"code":return this.renderer.code(t.text,t.lang);case"html":return this.renderer.html(t.text);case"table":{const s=t.header.map((l,f)=>this.renderer.tableCell(this.parseInline(l.tokens),{header:!0,align:t.align[f]})),r=this.renderer.tableRow(s),i=this.renderer.tableHeader(r),a=t.rows.map(l=>{const f=l.map((w,v)=>this.renderer.tableCell(this.parseInline(w.tokens),{header:!1,align:t.align[v]}));return this.renderer.tableRow(f)}),o=this.renderer.tableBody(a);return this.renderer.table([i,o])}case"hr":return this.renderer.hr();default:return console.warn(`Token with "${t.type}" type was not found`),null}})}parseInline(n=[]){return n.map(t=>{switch(t.type){case"text":return this.renderer.text(Vn(t.text));case"strong":return this.renderer.strong(this.parseInline(t.tokens));case"em":return this.renderer.em(this.parseInline(t.tokens));case"del":return this.renderer.del(this.parseInline(t.tokens));case"codespan":return this.renderer.codespan(Vn(t.text));case"link":return this.renderer.link(t.href,this.parseInline(t.tokens));case"image":return this.renderer.image(t.href,t.text,t.title);case"html":return this.renderer.html(t.text);case"br":return this.renderer.br();case"escape":return this.renderer.text(t.text);default:return console.warn(`Token with "${t.type}" type was not found`),null}})}}function W(e,n,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?e!==n||!s:!n.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(e):s?s.value:n.get(e)}function Ps(e,n,t,s,r){if(typeof n=="function"?e!==n||!r:!n.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n.set(e,t),t}var V,wt,Ke,Q,bn;class zi{constructor(n={}){V.add(this),wt.set(this,0),Ke.set(this,void 0);const{renderer:t}=n;Ps(this,Ke,n),t&&typeof t=="object"&&Object.entries(t).forEach(([s,r])=>{const i=s,a=r;!this[i]||i==="elementId"||typeof a!="function"||(this[i],this[i]=(...o)=>(W(this,V,"m",bn).call(this),a.apply(this,o)))})}get elementId(){return W(this,wt,"f")}heading(n,t){return W(this,V,"m",Q).call(this,`h${t}`,n)}paragraph(n){return W(this,V,"m",Q).call(this,"p",n)}link(n,t){const s=Xn(n,W(this,Ke,"f").baseURL),r=W(this,Ke,"f").openLinksInNewTab?"_blank":null;return W(this,V,"m",Q).call(this,"a",t,{href:s,target:r})}image(n,t,s=null){const r=Xn(n,W(this,Ke,"f").baseURL);return W(this,V,"m",Q).call(this,"img",null,{src:r,alt:t,title:s})}codespan(n,t=null){const s=t?`${W(this,Ke,"f").langPrefix}${t}`:null;return W(this,V,"m",Q).call(this,"code",n,{className:s})}code(n,t){return W(this,V,"m",Q).call(this,"pre",this.codespan(n,t))}blockquote(n){return W(this,V,"m",Q).call(this,"blockquote",n)}list(n,t){return W(this,V,"m",Q).call(this,t?"ol":"ul",n)}listItem(n){return W(this,V,"m",Q).call(this,"li",n)}checkbox(n){return W(this,V,"m",Q).call(this,"input",null,{type:"checkbox",disabled:!0,checked:n})}table(n){return W(this,V,"m",Q).call(this,"table",n)}tableHeader(n){return W(this,V,"m",Q).call(this,"thead",n)}tableBody(n){return W(this,V,"m",Q).call(this,"tbody",n)}tableRow(n){return W(this,V,"m",Q).call(this,"tr",n)}tableCell(n,t){const s=t.header?"th":"td";return W(this,V,"m",Q).call(this,s,n,{align:t.align})}strong(n){return W(this,V,"m",Q).call(this,"strong",n)}em(n){return W(this,V,"m",Q).call(this,"em",n)}del(n){return W(this,V,"m",Q).call(this,"del",n)}text(n){return n}html(n){return n}hr(){return W(this,V,"m",Q).call(this,"hr")}br(){return W(this,V,"m",Q).call(this,"br")}}wt=new WeakMap,Ke=new WeakMap,V=new WeakSet,Q=function(n,t=null,s={}){const r={key:`marked-react-${this.elementId}`};return W(this,V,"m",bn).call(this),D.createElement(n,Object.assign(Object.assign({},s),r),t)},bn=function(){Ps(this,wt,W(this,wt,"f")+1)};const Pi=e=>{if(e.value&&typeof e.value!="string")throw new TypeError(`[marked-react]: Expected value to be of type string but got ${typeof e.value}`);if(e.children&&typeof e.children!="string")throw new TypeError(`[marked-react]: Expected children to be of type string but got ${typeof e.children}`)},Li={isInline:!1,breaks:!1,gfm:!0,baseURL:void 0,openLinksInNewTab:!0,langPrefix:"language-",renderer:void 0},Ui=e=>{var n,t,s;Pi(e);const r=Object.assign(Object.assign({},Li),e),{current:i}=D.useRef((n=r.instance)!==null&&n!==void 0?n:new Is),a={breaks:r.breaks,gfm:r.gfm},o=(s=(t=r.value)!==null&&t!==void 0?t:r.children)!==null&&s!==void 0?s:"",l=r.isInline?i.Lexer.lexInline(o,a):i.lexer(o,a),f={renderer:new zi({renderer:r.renderer,baseURL:r.baseURL,openLinksInNewTab:r.openLinksInNewTab,langPrefix:r.langPrefix})},w=new Ii(f),v=r.isInline?w.parseInline(l):w.parse(l);return D.createElement(D.Fragment,null,v)};var Ls={exports:{}};(function(e){var n=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var t=function(s){var r=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,a={},o={manual:s.Prism&&s.Prism.manual,disableWorkerMessageHandler:s.Prism&&s.Prism.disableWorkerMessageHandler,util:{encode:function u(h){return h instanceof l?new l(h.type,u(h.content),h.alias):Array.isArray(h)?h.map(u):h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(u){return Object.prototype.toString.call(u).slice(8,-1)},objId:function(u){return u.__id||Object.defineProperty(u,"__id",{value:++i}),u.__id},clone:function u(h,p){p=p||{};var g,x;switch(o.util.type(h)){case"Object":if(x=o.util.objId(h),p[x])return p[x];g={},p[x]=g;for(var _ in h)h.hasOwnProperty(_)&&(g[_]=u(h[_],p));return g;case"Array":return x=o.util.objId(h),p[x]?p[x]:(g=[],p[x]=g,h.forEach(function(R,y){g[y]=u(R,p)}),g);default:return h}},getLanguage:function(u){for(;u;){var h=r.exec(u.className);if(h)return h[1].toLowerCase();u=u.parentElement}return"none"},setLanguage:function(u,h){u.className=u.className.replace(RegExp(r,"gi"),""),u.classList.add("language-"+h)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(g){var u=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(g.stack)||[])[1];if(u){var h=document.getElementsByTagName("script");for(var p in h)if(h[p].src==u)return h[p]}return null}},isActive:function(u,h,p){for(var g="no-"+h;u;){var x=u.classList;if(x.contains(h))return!0;if(x.contains(g))return!1;u=u.parentElement}return!!p}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(u,h){var p=o.util.clone(o.languages[u]);for(var g in h)p[g]=h[g];return p},insertBefore:function(u,h,p,g){g=g||o.languages;var x=g[u],_={};for(var R in x)if(x.hasOwnProperty(R)){if(R==h)for(var y in p)p.hasOwnProperty(y)&&(_[y]=p[y]);p.hasOwnProperty(R)||(_[R]=x[R])}var F=g[u];return g[u]=_,o.languages.DFS(o.languages,function(z,ne){ne===F&&z!=u&&(this[z]=_)}),_},DFS:function u(h,p,g,x){x=x||{};var _=o.util.objId;for(var R in h)if(h.hasOwnProperty(R)){p.call(h,R,h[R],g||R);var y=h[R],F=o.util.type(y);F==="Object"&&!x[_(y)]?(x[_(y)]=!0,u(y,p,null,x)):F==="Array"&&!x[_(y)]&&(x[_(y)]=!0,u(y,p,R,x))}}},plugins:{},highlightAll:function(u,h){o.highlightAllUnder(document,u,h)},highlightAllUnder:function(u,h,p){var g={callback:p,container:u,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",g),g.elements=Array.prototype.slice.apply(g.container.querySelectorAll(g.selector)),o.hooks.run("before-all-elements-highlight",g);for(var x=0,_;_=g.elements[x++];)o.highlightElement(_,h===!0,g.callback)},highlightElement:function(u,h,p){var g=o.util.getLanguage(u),x=o.languages[g];o.util.setLanguage(u,g);var _=u.parentElement;_&&_.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(_,g);var R=u.textContent,y={element:u,language:g,grammar:x,code:R};function F(ne){y.highlightedCode=ne,o.hooks.run("before-insert",y),y.element.innerHTML=y.highlightedCode,o.hooks.run("after-highlight",y),o.hooks.run("complete",y),p&&p.call(y.element)}if(o.hooks.run("before-sanity-check",y),_=y.element.parentElement,_&&_.nodeName.toLowerCase()==="pre"&&!_.hasAttribute("tabindex")&&_.setAttribute("tabindex","0"),!y.code){o.hooks.run("complete",y),p&&p.call(y.element);return}if(o.hooks.run("before-highlight",y),!y.grammar){F(o.util.encode(y.code));return}if(h&&s.Worker){var z=new Worker(o.filename);z.onmessage=function(ne){F(ne.data)},z.postMessage(JSON.stringify({language:y.language,code:y.code,immediateClose:!0}))}else F(o.highlight(y.code,y.grammar,y.language))},highlight:function(u,h,p){var g={code:u,grammar:h,language:p};if(o.hooks.run("before-tokenize",g),!g.grammar)throw new Error('The language "'+g.language+'" has no grammar.');return g.tokens=o.tokenize(g.code,g.grammar),o.hooks.run("after-tokenize",g),l.stringify(o.util.encode(g.tokens),g.language)},tokenize:function(u,h){var p=h.rest;if(p){for(var g in p)h[g]=p[g];delete h.rest}var x=new v;return b(x,x.head,u),w(u,x,h,x.head,0),E(x)},hooks:{all:{},add:function(u,h){var p=o.hooks.all;p[u]=p[u]||[],p[u].push(h)},run:function(u,h){var p=o.hooks.all[u];if(!(!p||!p.length))for(var g=0,x;x=p[g++];)x(h)}},Token:l};s.Prism=o;function l(u,h,p,g){this.type=u,this.content=h,this.alias=p,this.length=(g||"").length|0}l.stringify=function u(h,p){if(typeof h=="string")return h;if(Array.isArray(h)){var g="";return h.forEach(function(F){g+=u(F,p)}),g}var x={type:h.type,content:u(h.content,p),tag:"span",classes:["token",h.type],attributes:{},language:p},_=h.alias;_&&(Array.isArray(_)?Array.prototype.push.apply(x.classes,_):x.classes.push(_)),o.hooks.run("wrap",x);var R="";for(var y in x.attributes)R+=" "+y+'="'+(x.attributes[y]||"").replace(/"/g,"&quot;")+'"';return"<"+x.tag+' class="'+x.classes.join(" ")+'"'+R+">"+x.content+"</"+x.tag+">"};function f(u,h,p,g){u.lastIndex=h;var x=u.exec(p);if(x&&g&&x[1]){var _=x[1].length;x.index+=_,x[0]=x[0].slice(_)}return x}function w(u,h,p,g,x,_){for(var R in p)if(!(!p.hasOwnProperty(R)||!p[R])){var y=p[R];y=Array.isArray(y)?y:[y];for(var F=0;F<y.length;++F){if(_&&_.cause==R+","+F)return;var z=y[F],ne=z.inside,Le=!!z.lookbehind,O=!!z.greedy,P=z.alias;if(O&&!z.pattern.global){var le=z.pattern.toString().match(/[imsuy]*$/)[0];z.pattern=RegExp(z.pattern.source,le+"g")}for(var L=z.pattern||z,H=g.next,re=x;H!==h.tail&&!(_&&re>=_.reach);re+=H.value.length,H=H.next){var Me=H.value;if(h.length>u.length)return;if(!(Me instanceof l)){var st=1,Se;if(O){if(Se=f(L,re,u,Le),!Se||Se.index>=u.length)break;var Ct=Se.index,Bs=Se.index+Se[0].length,Ue=re;for(Ue+=H.value.length;Ct>=Ue;)H=H.next,Ue+=H.value.length;if(Ue-=H.value.length,re=Ue,H.value instanceof l)continue;for(var pt=H;pt!==h.tail&&(Ue<Bs||typeof pt.value=="string");pt=pt.next)st++,Ue+=pt.value.length;st--,Me=u.slice(re,Ue),Se.index-=re}else if(Se=f(L,0,Me,Le),!Se)continue;var Ct=Se.index,Nt=Se[0],Xt=Me.slice(0,Ct),Fn=Me.slice(Ct+Nt.length),Jt=re+Me.length;_&&Jt>_.reach&&(_.reach=Jt);var Ft=H.prev;Xt&&(Ft=b(h,Ft,Xt),re+=Xt.length),S(h,Ft,st);var Ws=new l(R,ne?o.tokenize(Nt,ne):Nt,P,Nt);if(H=b(h,Ft,Ws),Fn&&b(h,H,Fn),st>1){var Qt={cause:R+","+F,reach:Jt};w(u,h,p,H.prev,re,Qt),_&&Qt.reach>_.reach&&(_.reach=Qt.reach)}}}}}}function v(){var u={value:null,prev:null,next:null},h={value:null,prev:u,next:null};u.next=h,this.head=u,this.tail=h,this.length=0}function b(u,h,p){var g=h.next,x={value:p,prev:h,next:g};return h.next=x,g.prev=x,u.length++,x}function S(u,h,p){for(var g=h.next,x=0;x<p&&g!==u.tail;x++)g=g.next;h.next=g,g.prev=h,u.length-=x}function E(u){for(var h=[],p=u.head.next;p!==u.tail;)h.push(p.value),p=p.next;return h}if(!s.document)return s.addEventListener&&(o.disableWorkerMessageHandler||s.addEventListener("message",function(u){var h=JSON.parse(u.data),p=h.language,g=h.code,x=h.immediateClose;s.postMessage(o.highlight(g,o.languages[p],p)),x&&s.close()},!1)),o;var T=o.util.currentScript();T&&(o.filename=T.src,T.hasAttribute("data-manual")&&(o.manual=!0));function k(){o.manual||o.highlightAll()}if(!o.manual){var m=document.readyState;m==="loading"||m==="interactive"&&T&&T.defer?document.addEventListener("DOMContentLoaded",k):window.requestAnimationFrame?window.requestAnimationFrame(k):window.setTimeout(k,16)}return o}(n);e.exports&&(e.exports=t),typeof jn<"u"&&(jn.Prism=t),t.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},t.languages.markup.tag.inside["attr-value"].inside.entity=t.languages.markup.entity,t.languages.markup.doctype.inside["internal-subset"].inside=t.languages.markup,t.hooks.add("wrap",function(s){s.type==="entity"&&(s.attributes.title=s.content.replace(/&amp;/,"&"))}),Object.defineProperty(t.languages.markup.tag,"addInlined",{value:function(r,i){var a={};a["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:t.languages[i]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+i]={pattern:/[\s\S]+/,inside:t.languages[i]};var l={};l[r]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return r}),"i"),lookbehind:!0,greedy:!0,inside:o},t.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(t.languages.markup.tag,"addAttribute",{value:function(s,r){t.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+s+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[r,"language-"+r],inside:t.languages[r]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),t.languages.html=t.languages.markup,t.languages.mathml=t.languages.markup,t.languages.svg=t.languages.markup,t.languages.xml=t.languages.extend("markup",{}),t.languages.ssml=t.languages.xml,t.languages.atom=t.languages.xml,t.languages.rss=t.languages.xml,function(s){var r=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;s.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+r.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+r.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+r.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+r.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:r,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},s.languages.css.atrule.inside.rest=s.languages.css;var i=s.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(t),t.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},t.languages.javascript=t.languages.extend("clike",{"class-name":[t.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),t.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,t.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:t.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:t.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:t.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:t.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:t.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),t.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:t.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),t.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),t.languages.markup&&(t.languages.markup.tag.addInlined("script","javascript"),t.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),t.languages.js=t.languages.javascript,function(){if(typeof t>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var s="Loading…",r=function(T,k){return"✖ Error "+T+" while fetching file: "+k},i="✖ Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",f="loaded",w="failed",v="pre[data-src]:not(["+o+'="'+f+'"]):not(['+o+'="'+l+'"])';function b(T,k,m){var u=new XMLHttpRequest;u.open("GET",T,!0),u.onreadystatechange=function(){u.readyState==4&&(u.status<400&&u.responseText?k(u.responseText):u.status>=400?m(r(u.status,u.statusText)):m(i))},u.send(null)}function S(T){var k=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(T||"");if(k){var m=Number(k[1]),u=k[2],h=k[3];return u?h?[m,Number(h)]:[m,void 0]:[m,m]}}t.hooks.add("before-highlightall",function(T){T.selector+=", "+v}),t.hooks.add("before-sanity-check",function(T){var k=T.element;if(k.matches(v)){T.code="",k.setAttribute(o,l);var m=k.appendChild(document.createElement("CODE"));m.textContent=s;var u=k.getAttribute("data-src"),h=T.language;if(h==="none"){var p=(/\.(\w+)$/.exec(u)||[,"none"])[1];h=a[p]||p}t.util.setLanguage(m,h),t.util.setLanguage(k,h);var g=t.plugins.autoloader;g&&g.loadLanguages(h),b(u,function(x){k.setAttribute(o,f);var _=S(k.getAttribute("data-range"));if(_){var R=x.split(/\r\n?|\n/g),y=_[0],F=_[1]==null?R.length:_[1];y<0&&(y+=R.length),y=Math.max(0,Math.min(y-1,R.length)),F<0&&(F+=R.length),F=Math.max(0,Math.min(F,R.length)),x=R.slice(y,F).join(`
`),k.hasAttribute("data-start")||k.setAttribute("data-start",String(y+1))}m.textContent=x,t.highlightElement(m)},function(x){k.setAttribute(o,w),m.textContent=x})}}),t.plugins.fileHighlight={highlight:function(k){for(var m=(k||document).querySelectorAll(v),u=0,h;h=m[u++];)t.highlightElement(h)}};var E=!1;t.fileHighlight=function(){E||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),E=!0),t.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(Ls);var qi=Ls.exports;const Bi=is(qi);Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;(function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var n=e.languages.extend("typescript",{});delete n["class-name"],e.languages.typescript["class-name"].inside=n,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:n}}}}),e.languages.ts=e.languages.typescript})(Prism);Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/};Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python;Prism.languages.py=Prism.languages.python;(function(e){var n=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,t=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,s={pattern:RegExp(/(^|[^\w.])/.source+t+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[s,{pattern:RegExp(/(^|[^\w.])/.source+t+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:s.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+t+/[A-Z]\w*\b/.source),lookbehind:!0,inside:s.inside}],keyword:n,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":s,keyword:n,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+t+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:s.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+t+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:s.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return n.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(e){var n=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,t=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return n.source});e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return n.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:n,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return t})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])})(Prism);function Wi(){const{messages:e,isLoading:n,error:t,storeChat:s,setStoreChat:r,sendMessage:i,loadMessages:a}=bi(),[o,l]=D.useState(""),[f,w]=D.useState(!1),[v,b]=D.useState(!1),S=D.useRef(null);D.useEffect(()=>{a()},[a]),D.useEffect(()=>{S.current&&S.current.scrollIntoView({behavior:"smooth"})},[e]),D.useEffect(()=>{Bi.highlightAll()},[e]);const E=async()=>{if(!o.trim())return;const m=o;l(""),await i(m)},T=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),E())},k=async()=>{await r(!s)};return v?d.jsx("button",{onClick:()=>b(!1),className:"fixed bottom-4 right-4 p-4 bg-indigo-600 text-white rounded-full shadow-lg hover:bg-indigo-700 transition-all",children:d.jsx(on,{size:24})}):d.jsxs("div",{className:"flex flex-col h-[500px] w-[350px] bg-white rounded-lg shadow-lg",children:[d.jsxs("div",{className:"flex items-center justify-between bg-indigo-600 p-4 rounded-t-lg",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(on,{className:"text-white",size:24}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-white font-semibold",children:"AskLynk AI Assistant"}),d.jsx("p",{className:"text-indigo-200 text-sm",children:"Ask anything about the lecture"})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:k,className:`text-white hover:bg-indigo-700 rounded-full p-1 ${s?"text-green-300":"text-gray-300"}`,title:s?"Chat history is being saved":"Chat history is not being saved",children:d.jsx(Wr,{size:20})}),d.jsx("button",{onClick:()=>b(!0),className:"text-white hover:bg-indigo-700 rounded-full p-1",children:d.jsx(Ur,{size:20})})]})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t&&d.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded",children:t}),e.map(m=>d.jsx("div",{className:`flex ${m.role==="user"?"justify-end":"justify-start"}`,children:d.jsx("div",{className:`max-w-[80%] rounded-lg overflow-hidden ${m.role==="user"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-800"}`,children:d.jsx("div",{className:"p-3 prose prose-sm max-w-none",children:d.jsx(Ui,{children:m.content})})})},m.id)),n&&d.jsx("div",{className:"flex justify-center",children:d.jsxs("div",{className:"bg-gray-100 rounded-lg p-3 flex items-center gap-2",children:[d.jsx(Et,{className:"animate-spin text-indigo-600",size:16}),d.jsx("span",{className:"text-sm text-gray-600",children:"AI is thinking..."})]})}),d.jsx("div",{ref:S})]}),d.jsxs("div",{className:"p-4 border-t",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("textarea",{value:o,onChange:m=>l(m.target.value),onKeyPress:T,placeholder:"Ask anything about the lecture...",className:"flex-1 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none",rows:1,style:{minHeight:"40px",maxHeight:"120px"}}),d.jsx("button",{onClick:()=>w(!f),className:`p-2 rounded-full ${f?"bg-red-500":"bg-gray-200"} hover:bg-opacity-80`,children:d.jsx(_s,{size:20,className:f?"text-white":"text-gray-600"})}),d.jsx("button",{onClick:E,disabled:!o.trim()||n,className:"p-2 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 disabled:opacity-50",children:d.jsx(Vt,{size:20})})]}),d.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Press Enter to send, Shift + Enter for new line"})]})]})}const Tn=ft((e,n)=>({messages:[],isLoading:!1,error:null,sendMessage:async(t,s)=>{const r=ee.getState().session;if(r){e({isLoading:!0});try{const{data:i}=await M.auth.getUser();if(!i.user)throw new Error("User not authenticated");let a;if(s==="anonymous"){const{data:l,error:f}=await M.rpc("generate_anonymous_name",{p_session_id:r.id,p_user_id:i.user.id});if(f)throw f;a=l}const{error:o}=await M.from("chat_messages").insert({content:t,type:s,session_id:r.id,user_id:i.user.id,anonymous_name:a,anonymous_thread_id:s==="anonymous"?crypto.randomUUID():null,status:"sent"});if(o)throw o}catch(i){e({error:i.message})}finally{e({isLoading:!1})}}},markAsDelivered:async t=>{try{const{error:s}=await M.from("chat_messages").update({status:"delivered",delivered_at:new Date().toISOString()}).eq("id",t).is("delivered_at",null);if(s)throw s;e({messages:n().messages.map(r=>r.id===t?{...r,delivered_at:new Date().toISOString(),status:"delivered"}:r)})}catch(s){e({error:s.message})}},markAsRead:async t=>{try{const{error:s}=await M.from("chat_messages").update({status:"read",read_at:new Date().toISOString()}).eq("id",t).is("read_at",null);if(s)throw s;e({messages:n().messages.map(r=>r.id===t?{...r,read_at:new Date().toISOString(),status:"read"}:r)})}catch(s){e({error:s.message})}},loadMoreMessages:async()=>{const t=ee.getState().session;if(!t||n().isLoading||!n().messages.length)return;const s=n().messages[0];e({isLoading:!0});try{const{data:r,error:i}=await M.from("chat_messages").select(`
          *,
          profiles:user_id (full_name)
        `).eq("session_id",t.id).lt("created_at",s.created_at).order("created_at",{ascending:!1}).limit(20);if(i)throw i;if(r&&r.length>0){const a=r.map(o=>({...o,sender:o.profiles?{full_name:o.profiles.full_name}:void 0,sender_id:o.user_id,receiver_id:t.professor_id})).reverse();e({messages:[...a,...n().messages],isLoading:!1})}else e({isLoading:!1})}catch(r){e({error:r.message,isLoading:!1})}},upvoteMessage:async t=>{try{const{data:s,error:r}=await M.from("chat_messages").select("votes").eq("id",t).single();if(r)throw r;const a=((s==null?void 0:s.votes)||0)+1,{error:o}=await M.from("chat_messages").update({votes:a}).eq("id",t);if(o)throw o;e({messages:n().messages.map(l=>l.id===t?{...l,votes:a}:l)})}catch(s){e({error:s.message})}},setTyping:async t=>{const s=ee.getState().session;if(s)try{const{data:r}=await M.auth.getUser();if(!r.user)throw new Error("User not authenticated");await M.from("typing_status").upsert({session_id:s.id,user_id:r.user.id,is_typing:t,updated_at:new Date().toISOString()})}catch(r){console.error("Failed to update typing status:",r)}},subscribeToChat:()=>{const t=ee.getState().session;if(!t)return;e({isLoading:!0}),M.from("chat_messages").select(`
        *,
        profiles:user_id (full_name)
      `).eq("session_id",t.id).order("created_at",{ascending:!0}).then(({data:r,error:i})=>{if(i)e({error:i.message});else{const a=(r||[]).map(o=>({...o,sender:o.profiles?{full_name:o.profiles.full_name}:void 0,sender_id:o.user_id,receiver_id:t.professor_id,user_full_name:o.profiles?o.profiles.full_name:void 0}));e({messages:a})}e({isLoading:!1})});const s=M.channel(`chat:${t.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`session_id=eq.${t.id}`},async r=>{const{data:i}=await M.from("profiles").select("full_name").eq("id",r.new.user_id).single(),a={...r.new,sender:i?{full_name:i.full_name}:void 0,sender_id:r.new.user_id,receiver_id:t.professor_id,user_full_name:i?i.full_name:void 0};e({messages:[...n().messages,a]})}).subscribe();return()=>{s.unsubscribe()}},unsubscribeFromChat:()=>{const t=ee.getState().session;t&&M.channel(`chat:${t.id}`).unsubscribe()}}));function Gi(){const{user:e}=ke(),{session:n}=ee(),{messages:t,isLoading:s,error:r,sendMessage:i,upvoteMessage:a,markAsDelivered:o,markAsRead:l,setTyping:f,subscribeToChat:w,unsubscribeFromChat:v,loadMoreMessages:b}=Tn(),[S,E]=D.useState(""),[T,k]=D.useState(),m=D.useRef(null),u=D.useRef(null);D.useEffect(()=>(n!=null&&n.id&&w(),()=>v()),[n==null?void 0:n.id,w,v]),D.useEffect(()=>{m.current&&m.current.scrollIntoView({behavior:"smooth"})},[t]),D.useEffect(()=>{const y=t.filter(F=>F.user_id!==(e==null?void 0:e.id)&&!F.delivered_at&&F.type==="public");y.length>0&&y.forEach(F=>o(F.id))},[t,e==null?void 0:e.id,o]),D.useEffect(()=>{const y=t.filter(F=>F.user_id!==(e==null?void 0:e.id)&&!F.read_at&&F.type==="public");y.length>0&&y.forEach(F=>l(F.id))},[t,e==null?void 0:e.id,l]);const h=()=>{const y=u.current;y&&y.scrollTop===0&&!s&&b()},p=y=>{E(y.target.value),T&&clearTimeout(T),f(!0);const F=setTimeout(()=>f(!1),1e3);k(F)},g=async()=>{if(S.trim())try{await i(S,"public"),E("")}catch(y){console.error("Failed to send message:",y)}},x=y=>new Date(y).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),_=y=>y.user_id===(e==null?void 0:e.id)?y.read_at?d.jsxs("div",{className:"flex items-center gap-0.5 text-blue-600",children:[d.jsx(he,{size:14}),d.jsx(he,{size:14})]}):y.delivered_at?d.jsxs("div",{className:"flex items-center gap-0.5 text-gray-600",children:[d.jsx(he,{size:14}),d.jsx(he,{size:14})]}):d.jsx("div",{className:"flex items-center text-gray-400",children:d.jsx(he,{size:14})}):null;if(!n)return null;const R=t.filter(y=>y.type==="public");return d.jsxs("div",{className:"flex flex-col h-[500px] bg-white rounded-lg",children:[d.jsx("div",{className:"bg-green-600 p-4 rounded-t-lg",children:d.jsxs("h2",{className:"text-white font-semibold flex items-center gap-2",children:[d.jsx(vs,{size:20}),"Classroom Chat"]})}),r&&d.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4",children:r}),d.jsxs("div",{ref:u,className:"flex-1 overflow-y-auto p-4 space-y-4",onScroll:h,children:[s&&d.jsx("div",{className:"flex justify-center",children:d.jsx(Et,{className:"animate-spin text-gray-500",size:24})}),R.map(y=>d.jsxs("div",{className:`flex flex-col ${y.user_id===(e==null?void 0:e.id)?"items-end":"items-start"}`,children:[d.jsxs("div",{className:"flex items-start gap-2 max-w-[80%]",children:[d.jsxs("div",{className:`rounded-lg p-3 ${y.user_id===(e==null?void 0:e.id)?"bg-green-600 text-white":"bg-gray-100 text-gray-800"}`,children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx("span",{className:"font-medium text-sm",children:y.user_full_name}),d.jsx("span",{className:"text-xs opacity-75",children:x(y.created_at)})]}),d.jsx("p",{children:y.content})]}),y.user_id!==(e==null?void 0:e.id)&&d.jsxs("button",{onClick:()=>a(y.id),className:"flex items-center gap-1 text-sm text-gray-500 hover:text-green-600 p-1",children:[d.jsx(Hr,{size:16}),(y.votes??0)>0&&d.jsx("span",{className:"font-medium",children:y.votes??0})]})]}),_(y)]},y.id)),d.jsx("div",{ref:m})]}),d.jsx("div",{className:"p-4 border-t",children:d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",value:S,onChange:p,onKeyPress:y=>y.key==="Enter"&&g(),placeholder:"Share your thoughts with the class...",className:"flex-1 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),d.jsx("button",{onClick:g,disabled:!S.trim(),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:d.jsx(Vt,{size:20})})]})})]})}const Hi=ft((e,n)=>({messages:[],isLoading:!1,error:null,sendMessage:async(t,s,r=!1,i)=>{const a=ee.getState().session,o=ke.getState().user;if(!(!a||!o))try{let l;if(r||i)if(i){const{data:w}=await M.from("private_messages").select("anonymous_name").eq("anonymous_thread_id",i).single();l=w==null?void 0:w.anonymous_name}else{const{data:w,error:v}=await M.rpc("generate_anonymous_name",{p_session_id:a.id,p_user_id:o.id});if(v)throw v;l=w}const{error:f}=await M.from("private_messages").insert({content:s,session_id:a.id,sender_id:o.id,receiver_id:t,type:r||i?"anonymous":"private",anonymous_name:l,anonymous_thread_id:i||(r?crypto.randomUUID():null),status:"sent"});if(f)throw f}catch(l){e({error:l.message})}},markAsDelivered:async t=>{try{const{error:s}=await M.from("private_messages").update({status:"delivered",delivered_at:new Date().toISOString()}).eq("id",t).is("delivered_at",null);if(s)throw s}catch(s){e({error:s.message})}},markAsRead:async t=>{try{const{error:s}=await M.from("private_messages").update({status:"read",read_at:new Date().toISOString()}).eq("id",t).is("read_at",null);if(s)throw s}catch(s){e({error:s.message})}},loadMoreMessages:async()=>{const t=ee.getState().session,s=ke.getState().user,r=n().messages;if(!t||!s||!r.length||n().isLoading)return;const i=r.reduce((a,o)=>{const l=new Date(o.created_at);return l<a?l:a},new Date);e({isLoading:!0});try{const{data:a,error:o}=await M.from("private_messages").select(`
          *,
          sender:profiles!private_messages_sender_id_fkey(full_name),
          receiver:profiles!private_messages_receiver_id_fkey(full_name)
        `).eq("session_id",t.id).or(`sender_id.eq.${s.id},receiver_id.eq.${s.id}`).lt("created_at",i.toISOString()).order("created_at",{ascending:!1}).limit(20);if(o)throw o;a&&a.length>0?e({messages:[...a.reverse(),...r],isLoading:!1}):e({isLoading:!1})}catch(a){e({error:a.message,isLoading:!1})}},subscribeToPrivateChat:()=>{const t=ee.getState().session,s=ke.getState().user;if(!t||!s)return;e({isLoading:!0}),M.from("private_messages").select(`
        *,
        sender:profiles!private_messages_sender_id_fkey(full_name),
        receiver:profiles!private_messages_receiver_id_fkey(full_name)
      `).eq("session_id",t.id).or(`sender_id.eq.${s.id},receiver_id.eq.${s.id}`).order("created_at",{ascending:!0}).then(({data:i,error:a})=>{e(a?{error:a.message}:{messages:i||[]}),e({isLoading:!1})});const r=M.channel(`private-chat:${t.id}:${s.id}`).on("postgres_changes",{event:"*",schema:"public",table:"private_messages",filter:`session_id=eq.${t.id}`},async i=>{if(i.eventType==="INSERT"){const a=i.new;if(a.sender_id===s.id||a.receiver_id===s.id){const{data:o}=await M.from("profiles").select("id, full_name").in("id",[a.sender_id,a.receiver_id]),l=o==null?void 0:o.find(v=>v.id===a.sender_id),f=o==null?void 0:o.find(v=>v.id===a.receiver_id),w={...a,sender:l?{full_name:l.full_name}:void 0,receiver:f?{full_name:f.full_name}:void 0};e({messages:[...n().messages,w]})}}else i.eventType==="UPDATE"&&e({messages:n().messages.map(a=>a.id===i.new.id?{...a,...i.new}:a)})}).subscribe();return()=>{r.unsubscribe()}},unsubscribeFromPrivateChat:()=>{const t=ee.getState().session,s=ke.getState().user;t&&s&&M.channel(`private-chat:${t.id}:${s.id}`).unsubscribe()}}));function Us(e){return e.type==="private"||e.type==="anonymous"}function Yi(e){return e.type==="public"||e.type==="question"||e.type==="anonymous"}function mt(e){return Us(e)?e.sender_id:e.sender_id||e.user_id}function it(e){return Us(e),e.receiver_id}function an(e){return e.anonymous_thread_id}function Jn(e){return Yi(e)?e.user_id:e.sender_id}function Qn(e){return!!e.read_at}function Zi(){const{user:e}=ke(),{session:n}=ee(),{messages:t,isLoading:s,error:r}=Tn(),{messages:i,isLoading:a,error:o,sendMessage:l,markAsDelivered:f,markAsRead:w}=Hi(),[v,b]=D.useState(""),[S,E]=D.useState(null),[T,k]=D.useState(""),[m,u]=D.useState([]),h=D.useRef(null),[p,g]=D.useState(!1),[x,_]=D.useState(!1);D.useEffect(()=>{const O=()=>{g(window.innerWidth<768)};return O(),window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[]),D.useEffect(()=>{h.current&&h.current.scrollIntoView({behavior:"smooth"})},[i,S]),D.useEffect(()=>{const O=i.filter(P=>it(P)===(e==null?void 0:e.id)&&!P.delivered_at);if(O.length>0&&O.forEach(P=>f(P.id)),S){const P=i.filter(le=>{var L;return it(le)===(e==null?void 0:e.id)&&!le.read_at&&(le.anonymous_name===S.name||((L=le.sender)==null?void 0:L.full_name)===S.name)});P.length>0&&P.forEach(le=>w(le.id))}},[i,e==null?void 0:e.id,S,f,w]),D.useEffect(()=>{const O=new Map;[...t,...i].filter(L=>L.type==="anonymous").forEach(L=>{const H=an(L)||L.anonymous_name||Jn(L),re=O.get(H);if(!re)O.set(H,{id:H,name:L.anonymous_name||"Anonymous Student",isAnonymous:!0,userId:Jn(L),anonymousThreadId:an(L),lastMessage:{content:L.content,timestamp:L.created_at,isRead:Qn(L)},unreadCount:it(L)===(e==null?void 0:e.id)&&!L.read_at?1:0});else{const Me=new Date(L.created_at).getTime(),st=new Date(re.lastMessage.timestamp).getTime();Me>st&&(re.lastMessage={content:L.content,timestamp:L.created_at,isRead:Qn(L)}),it(L)===(e==null?void 0:e.id)&&!L.read_at&&re.unreadCount++}});const le=Array.from(O.values()).sort((L,H)=>new Date(H.lastMessage.timestamp).getTime()-new Date(L.lastMessage.timestamp).getTime()).filter(L=>L.name.toLowerCase().includes(v.toLowerCase()));u(le)},[t,i,v,e==null?void 0:e.id]);const R=async()=>{if(!(!T.trim()||!S))try{await l(S.userId||S.id,T,S.isAnonymous,S.anonymousThreadId),k("")}catch(O){console.error("Failed to send reply:",O)}},y=O=>{const P=new Date(O),le=new Date,L=new Date(le);return L.setDate(L.getDate()-1),P.toDateString()===le.toDateString()?P.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):P.toDateString()===L.toDateString()?"Yesterday":P.toLocaleDateString([],{month:"short",day:"numeric"})},F=O=>mt(O)===(e==null?void 0:e.id)?O.read_at?d.jsxs("div",{className:"flex items-center gap-0.5 text-blue-600",children:[d.jsx(he,{size:14}),d.jsx(he,{size:14})]}):O.delivered_at?d.jsxs("div",{className:"flex items-center gap-0.5 text-gray-600",children:[d.jsx(he,{size:14}),d.jsx(he,{size:14})]}):d.jsx("div",{className:"flex items-center text-gray-400",children:d.jsx(he,{size:14})}):null,z=O=>[...t,...i].filter(P=>an(P)===O.anonymousThreadId||P.anonymous_name===O.name||P.type==="private"&&(mt(P)===O.userId&&it(P)===(e==null?void 0:e.id)||mt(P)===(e==null?void 0:e.id)&&it(P)===O.userId)).sort((P,le)=>new Date(P.created_at).getTime()-new Date(le.created_at).getTime());if(!n)return null;const ne=()=>d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsx("div",{className:"p-4 bg-purple-600",children:d.jsxs("h2",{className:"text-white font-semibold flex items-center gap-2",children:[d.jsx(Pt,{size:20}),"Student Messages"]})}),d.jsx("div",{className:"p-4 border-b",children:d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:v,onChange:O=>b(O.target.value),placeholder:"Search conversations...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),d.jsx(Gr,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]})}),d.jsx("div",{className:"flex-1 overflow-y-auto",children:m.map(O=>d.jsxs("div",{onClick:()=>{E(O),p&&_(!0)},className:`p-4 border-b hover:bg-gray-50 cursor-pointer ${(S==null?void 0:S.id)===O.id?"bg-purple-50":""}`,children:[d.jsxs("div",{className:"flex justify-between items-start mb-1",children:[d.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[O.name,O.isAnonymous&&d.jsx("span",{className:"text-xs bg-purple-100 text-purple-600 px-2 py-0.5 rounded-full",children:"Anonymous"})]}),d.jsx("span",{className:"text-xs text-gray-500",children:y(O.lastMessage.timestamp)})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("p",{className:"text-sm text-gray-600 truncate max-w-[80%]",children:O.lastMessage.content}),O.unreadCount>0&&d.jsx("span",{className:"bg-purple-600 text-white text-xs px-2 py-1 rounded-full",children:O.unreadCount})]})]},O.id))})]}),Le=()=>{if(!S)return d.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:d.jsx("p",{children:"Select a conversation to start messaging"})});const O=z(S);return d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsxs("div",{className:"p-4 bg-purple-600 flex items-center gap-4",children:[p&&d.jsx("button",{onClick:()=>_(!1),className:"text-white hover:bg-purple-700 p-1 rounded",children:d.jsx(Lr,{size:24})}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-white font-semibold",children:S.name}),S.isAnonymous&&d.jsx("span",{className:"text-xs bg-purple-800 text-purple-100 px-2 py-0.5 rounded-full",children:"Anonymous"})]})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[O.map(P=>d.jsx("div",{className:`flex flex-col ${mt(P)===(e==null?void 0:e.id)?"items-end":"items-start"}`,children:d.jsxs("div",{className:"max-w-[80%]",children:[d.jsx("div",{className:`rounded-lg p-3 ${mt(P)===(e==null?void 0:e.id)?"bg-purple-600 text-white":"bg-gray-100 text-gray-800"}`,children:d.jsx("p",{children:P.content})}),d.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500",children:[d.jsx("span",{children:y(P.created_at)}),F(P)]})]})},P.id)),d.jsx("div",{ref:h})]}),d.jsx("div",{className:"p-4 border-t",children:d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",value:T,onChange:P=>k(P.target.value),onKeyPress:P=>P.key==="Enter"&&R(),placeholder:"Type a message...",className:"flex-1 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),d.jsx("button",{onClick:R,disabled:!T.trim(),className:"p-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:d.jsx(Vt,{size:20})})]})})]})};return s||a?d.jsx("div",{className:"h-[500px] w-full flex items-center justify-center",children:d.jsx(Et,{className:"animate-spin text-purple-600",size:32})}):r||o?d.jsx("div",{className:"p-4 bg-red-100 text-red-700 rounded-lg",children:r||o}):d.jsx("div",{className:"h-[500px] bg-white rounded-lg shadow-lg overflow-hidden",children:d.jsxs("div",{className:"h-full md:grid md:grid-cols-[350px,1fr]",children:[d.jsx("div",{className:`h-full border-r ${p&&x?"hidden":""}`,children:ne()}),d.jsx("div",{className:`h-full ${p&&!x?"hidden":""}`,children:Le()})]})})}function Ki(){const{user:e}=ke(),{session:n}=ee(),{messages:t,isLoading:s,error:r,sendMessage:i,markAsDelivered:a,markAsRead:o}=Tn(),[l,f]=D.useState(""),[w,v]=D.useState(null),b=D.useRef(null);if(D.useRef(null),(e==null?void 0:e.role)==="professor")return d.jsx(Zi,{});D.useEffect(()=>{b.current&&b.current.scrollIntoView({behavior:"smooth"})},[t]),D.useEffect(()=>{const m=t.filter(u=>u.user_id!==(e==null?void 0:e.id)&&!u.delivered_at&&u.type==="anonymous");m.length>0&&m.forEach(u=>a(u.id))},[t,e==null?void 0:e.id,a]),D.useEffect(()=>{const m=t.filter(u=>u.user_id!==(e==null?void 0:e.id)&&!u.read_at&&u.type==="anonymous");m.length>0&&m.forEach(u=>o(u.id))},[t,e==null?void 0:e.id,o]),D.useEffect(()=>{n!=null&&n.id&&(e!=null&&e.id)&&(async()=>{try{const{data:u,error:h}=await M.rpc("generate_anonymous_name",{p_session_id:n.id,p_user_id:e.id});if(h)throw h;v(u)}catch(u){console.error("Failed to fetch anonymous name:",u)}})()},[n==null?void 0:n.id,e==null?void 0:e.id]);const S=async()=>{if(!(!l.trim()||!n))try{await i(l,"anonymous"),f("")}catch(m){console.error("Failed to send message:",m)}},E=m=>new Date(m).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),T=m=>m.user_id===(e==null?void 0:e.id)?m.read_at?d.jsxs("div",{className:"flex items-center gap-0.5 text-blue-600",children:[d.jsx(he,{size:14}),d.jsx(he,{size:14})]}):m.delivered_at?d.jsxs("div",{className:"flex items-center gap-0.5 text-gray-600",children:[d.jsx(he,{size:14}),d.jsx(he,{size:14})]}):d.jsx("div",{className:"flex items-center text-gray-400",children:d.jsx(he,{size:14})}):null,k=t.filter(m=>m.type==="anonymous");return d.jsxs("div",{className:"flex flex-col h-[500px] w-[350px] bg-white rounded-lg shadow-lg",children:[d.jsxs("div",{className:"bg-purple-600 p-4 rounded-t-lg",children:[d.jsxs("h2",{className:"text-white font-semibold flex items-center gap-2",children:[d.jsx(Pt,{size:20}),"Anonymous Message to Professor"]}),w&&d.jsxs("p",{className:"text-purple-100 text-sm mt-1",children:["You appear as: ",w]})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[r&&d.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:r}),s&&d.jsx("div",{className:"flex justify-center",children:d.jsx(Et,{className:"animate-spin text-gray-500",size:24})}),k.map(m=>d.jsxs("div",{className:`flex flex-col ${m.user_id===(e==null?void 0:e.id)?"items-end":"items-start"}`,children:[d.jsx("div",{className:"flex items-start gap-2 max-w-[80%]",children:d.jsxs("div",{className:`rounded-lg p-3 ${m.user_id===(e==null?void 0:e.id)?"bg-purple-600 text-white":"bg-gray-100 text-gray-800"}`,children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx("span",{className:"font-medium text-sm",children:m.anonymous_name||"Anonymous"}),d.jsx("span",{className:"text-xs opacity-75",children:E(m.created_at)})]}),d.jsx("p",{children:m.content})]})}),T(m)]},m.id)),d.jsx("div",{ref:b})]}),d.jsxs("div",{className:"p-4 border-t",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",value:l,onChange:m=>f(m.target.value),onKeyPress:m=>m.key==="Enter"&&S(),placeholder:"Send an anonymous message...",className:"flex-1 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),d.jsx("button",{onClick:S,disabled:!l.trim(),className:"p-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:d.jsx(Vt,{size:20})})]}),d.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[d.jsx(Pt,{size:12}),"Your identity will remain anonymous"]})]})]})}const Vi=new Ts("AIzaSyAjiPCuBtp8NW06-MFpaM4ZOWJs6WGoR7Y"),Xi=ft((e,n)=>({polls:[],votes:{},isLoading:!1,error:null,generatePollFromTopic:async t=>{const s=Vi.getGenerativeModel({model:"gemini-1.5-pro-002"}),r=`Generate an engaging multiple choice poll question about ${t}. 
      Return a JSON object with:
      - question: the poll question (make it engaging and relevant)
      - options: array of 4 possible answers (make them clear and distinct)
      Format it exactly like this example:
      {
        "question": "What is the primary cause of climate change?",
        "options": ["Deforestation", "Fossil fuel emissions", "Industrial waste", "Agricultural practices"]
      }`;try{const a=await(await s.generateContent(r)).response.text(),o=JSON.parse(a);if(!o.question||!Array.isArray(o.options)||o.options.length!==4)throw new Error("Invalid AI response format");return o}catch(i){throw console.error("Failed to generate poll:",i),new Error("Failed to generate poll question. Please try again.")}},createPoll:async(t,s,r,i=30)=>{const a=ee.getState().session,o=ke.getState().user;if(!a||!o){e({error:"No active session or user"});return}if(o.role!=="professor"){e({error:"Only professors can create polls"});return}e({isLoading:!0,error:null});try{const{data:l,error:f}=await M.from("polls").insert([{session_id:a.id,professor_id:o.id,question:t,options:JSON.stringify(s),voice_transcript:r,duration:i,metadata:{autoClose:!0}}]).select().single();if(f)throw f;l&&(e({polls:[...n().polls,l]}),i>0&&setTimeout(()=>{n().endPoll(l.id)},i*1e3))}catch(l){throw e({error:l.message}),l}finally{e({isLoading:!1})}},endPoll:async t=>{const s=ke.getState().user;if(!s||s.role!=="professor"){e({error:"Only professors can end polls"});return}try{const{error:r}=await M.from("polls").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",t);if(r)throw r;e({polls:n().polls.map(i=>i.id===t?{...i,status:"ended",ended_at:new Date().toISOString()}:i)})}catch(r){e({error:r.message})}},vote:async(t,s)=>{const r=ke.getState().user;if(r)try{const{error:i}=await M.from("poll_votes").insert([{poll_id:t,option_index:s,user_id:r.id}]);if(i)throw i;const o=[...n().votes[t]||[]];o[s]=(o[s]||0)+1,e({votes:{...n().votes,[t]:o}})}catch(i){e({error:i.message})}},subscribeToPollUpdates:()=>{const t=ee.getState().session;if(!t)return;M.from("polls").select("*").eq("session_id",t.id).order("created_at",{ascending:!1}).then(({data:i,error:a})=>{e(a?{error:a.message}:{polls:i||[]})});const s=M.channel("polls").on("postgres_changes",{event:"*",schema:"public",table:"polls",filter:`session_id=eq.${t.id}`},i=>{i.eventType==="INSERT"?e({polls:[i.new,...n().polls]}):i.eventType==="UPDATE"&&e({polls:n().polls.map(a=>a.id===i.new.id?{...a,...i.new}:a)})}).subscribe(),r=M.channel("poll_votes").on("postgres_changes",{event:"INSERT",schema:"public",table:"poll_votes"},async i=>{const a=i.new,l=[...n().votes[a.poll_id]||[]];l[a.option_index]=(l[a.option_index]||0)+1,e({votes:{...n().votes,[a.poll_id]:l}})}).subscribe();return()=>{s.unsubscribe(),r.unsubscribe()}},unsubscribeFromPolls:()=>{ee.getState().session&&(M.channel("polls").unsubscribe(),M.channel("poll_votes").unsubscribe())}}));function Ji(){const{user:e}=ke();ee();const{polls:n,votes:t,createPoll:s,endPoll:r,vote:i,subscribeToPollUpdates:a,unsubscribeFromPolls:o,isLoading:l,error:f}=Xi(),[w,v]=D.useState(!1),[b,S]=D.useState(""),[E,T]=D.useState([{text:""},{text:""}]),[k,m]=D.useState(30);D.useEffect(()=>(a(),()=>o()),[a,o]);const u=()=>{T([...E,{text:""}])},h=y=>{T(E.filter((F,z)=>z!==y))},p=(y,F)=>{const z=[...E];z[y].text=F,T(z)},g=async()=>{try{await s(b,E.map(y=>y.text),void 0,k),v(!1),S(""),T([{text:""},{text:""}])}catch(y){console.error("Failed to create poll:",y)}},x=async(y,F)=>{try{await i(y,F)}catch(z){console.error("Failed to vote:",z)}},_=(y,F)=>{const z=t[y];if(!z)return 0;const ne=z.reduce((Le,O)=>Le+O,0);return ne===0?0:Math.round(z[F]/ne*100)},R=(e==null?void 0:e.role)==="professor";return d.jsxs("div",{className:"flex flex-col h-[500px] w-[350px] bg-white rounded-lg shadow-lg",children:[d.jsx("div",{className:"bg-blue-600 p-4 rounded-t-lg",children:d.jsxs("h2",{className:"text-white font-semibold flex items-center gap-2",children:[d.jsx(ws,{size:20}),"Live Polls"]})}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[f&&d.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:f}),R&&w&&d.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question"}),d.jsx("input",{type:"text",value:b,onChange:y=>S(y.target.value),placeholder:"Enter your question...",className:"w-full p-2 border rounded-lg"})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (seconds)"}),d.jsx("input",{type:"number",value:k,onChange:y=>m(parseInt(y.target.value,10)),min:"5",max:"300",className:"w-full p-2 border rounded-lg"})]}),E.map((y,F)=>d.jsxs("div",{className:"flex gap-2 mb-2",children:[d.jsx("input",{type:"text",value:y.text,onChange:z=>p(F,z.target.value),placeholder:`Option ${F+1}`,className:"flex-1 p-2 border rounded-lg"}),E.length>2&&d.jsx("button",{onClick:()=>h(F),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:d.jsx(ks,{size:20})})]},F)),d.jsxs("div",{className:"flex gap-2 mt-4",children:[d.jsxs("button",{onClick:u,className:"flex items-center gap-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:[d.jsx(Dn,{size:16}),"Add Option"]}),d.jsxs("button",{onClick:g,disabled:l,className:"flex items-center gap-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[l?d.jsx(Et,{size:16,className:"animate-spin"}):d.jsx(he,{size:16}),"Create Poll"]})]})]}),n.map(y=>d.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsx("h3",{className:"font-medium",children:y.question}),y.voice_transcript&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[d.jsx(_s,{size:12}),"Voice Created"]})]}),d.jsx("div",{className:"space-y-2",children:y.options.map((F,z)=>{const ne=_(y.id,z);return d.jsxs("button",{onClick:()=>x(y.id,z),disabled:y.status==="ended"||l,className:"w-full p-2 bg-white border rounded-lg hover:bg-gray-50 disabled:opacity-50 relative overflow-hidden",children:[d.jsx("div",{className:"absolute left-0 top-0 bottom-0 bg-blue-100 transition-all",style:{width:`${ne}%`}}),d.jsxs("div",{className:"relative flex justify-between",children:[d.jsx("span",{children:F}),d.jsxs("span",{children:[ne,"%"]})]})]},z)})}),R&&y.status==="active"&&d.jsx("button",{onClick:()=>r(y.id),className:"mt-4 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:"End Poll"})]},y.id))]}),R&&!w&&d.jsx("div",{className:"p-4 border-t",children:d.jsxs("button",{onClick:()=>v(!0),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2",children:[d.jsx(Dn,{size:20}),"Create New Poll"]})})]})}function Qi(){if(document.getElementById("asklynk-overlay-container"))return;const e=document.createElement("div");e.id="asklynk-overlay-container",e.className="asklynk-overlay-container",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.zIndex="999999",e.style.pointerEvents="none",document.body.appendChild(e);const n=document.createElement("div");n.id="asklynk-floating-overlay",n.style.position="absolute",n.style.pointerEvents="auto",n.style.width="320px",n.style.height="auto",n.style.background="white",n.style.borderRadius="8px",n.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)",n.style.transition="all 0.3s ease",e.appendChild(n)}const ea={x:window.innerWidth>320?(window.innerWidth-320)/2:10,y:20},Cn=ft(e=>{const n={activeTab:null,isMinimized:!0,position:ea,toggleTab:t=>e(s=>({activeTab:s.activeTab===t?null:t,isMinimized:!1})),setActiveTab:t=>e({activeTab:t,isMinimized:!1}),setMinimized:t=>e({isMinimized:t}),closeOverlay:()=>e({activeTab:null,isMinimized:!0}),setPosition:t=>e({position:t})};return typeof window<"u"&&(window.__ASKLYNK_OVERLAY_STORE__=n,Qi()),n});function ta(){const{activeTab:e,isMinimized:n,position:t,toggleTab:s,setMinimized:r,closeOverlay:i,setPosition:a}=Cn(),{session:o}=ee(),l=D.useRef(null),f=D.useRef(null),[w,v]=D.useState({left:0,top:0,right:0,bottom:0}),[b,S]=D.useState(!1);D.useEffect(()=>{const u=()=>{if(l.current){const h=l.current.getBoundingClientRect();v({left:0,top:0,right:window.innerWidth-h.width,bottom:window.innerHeight-h.height})}};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[e,n]),D.useEffect(()=>{const u={x:Math.min(Math.max(t.x,w.left),w.right),y:Math.min(Math.max(t.y,w.top),w.bottom)};(u.x!==t.x||u.y!==t.y)&&a(u)},[w,t,a]);const E=u=>u==="ai"?!0:(o==null?void 0:o.status)==="active",T=(u,h)=>{const p={x:Math.min(Math.max(h.x,w.left),w.right),y:Math.min(Math.max(h.y,w.top),w.bottom)};a(p)},k=u=>{E(u)&&(S(!0),s(u),setTimeout(()=>S(!1),300))},m=(u,h)=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),k(h))};return!e&&!n?null:d.jsx("div",{className:"fixed inset-0 pointer-events-none",children:d.jsx(Pr,{nodeRef:f,position:t,onStop:T,bounds:"parent",handle:".overlay-header",children:d.jsx("div",{ref:f,className:"absolute pointer-events-auto",style:{zIndex:9999},children:n?d.jsx("button",{onClick:()=>r(!1),className:"bg-indigo-600 text-white p-3 rounded-full shadow-lg hover:bg-indigo-700 transition-colors","aria-label":"Maximize overlay",children:d.jsx(qr,{size:24})}):d.jsxs("div",{ref:l,className:"bg-white rounded-lg shadow-xl transition-all duration-300",role:"dialog","aria-label":"Chat overlay",children:[d.jsxs("div",{className:"overlay-header flex items-center justify-between p-2 bg-gray-100 rounded-t-lg cursor-grab active:cursor-grabbing",children:[d.jsxs("div",{className:"flex gap-2",role:"tablist","aria-label":"Chat features",children:[d.jsxs("button",{role:"tab","aria-selected":e==="ai","aria-controls":"ai-panel",onClick:()=>k("ai"),onKeyDown:u=>m(u,"ai"),className:`p-2 rounded-lg transition-colors ${e==="ai"?"bg-indigo-600 text-white":"text-gray-600 hover:bg-gray-200"}`,children:[d.jsx(on,{size:20}),d.jsx("span",{className:"sr-only",children:"AI Assistant"})]}),d.jsxs("button",{role:"tab","aria-selected":e==="chat","aria-controls":"chat-panel",onClick:()=>k("chat"),onKeyDown:u=>m(u,"chat"),disabled:!E("chat"),className:`p-2 rounded-lg transition-colors ${E("chat")?e==="chat"?"bg-green-600 text-white":"text-gray-600 hover:bg-gray-200":"opacity-50 cursor-not-allowed text-gray-400"}`,title:E("chat")?"":"Join a session to access class chat",children:[d.jsx(vs,{size:20}),d.jsx("span",{className:"sr-only",children:"Class Chat"})]}),d.jsxs("button",{role:"tab","aria-selected":e==="anonymous","aria-controls":"anonymous-panel",onClick:()=>k("anonymous"),onKeyDown:u=>m(u,"anonymous"),disabled:!E("anonymous"),className:`p-2 rounded-lg transition-colors ${E("anonymous")?e==="anonymous"?"bg-purple-600 text-white":"text-gray-600 hover:bg-gray-200":"opacity-50 cursor-not-allowed text-gray-400"}`,title:E("anonymous")?"":"Join a session to send anonymous messages",children:[d.jsx(Pt,{size:20}),d.jsx("span",{className:"sr-only",children:"Anonymous Messages"})]}),d.jsxs("button",{role:"tab","aria-selected":e==="polls","aria-controls":"polls-panel",onClick:()=>k("polls"),onKeyDown:u=>m(u,"polls"),disabled:!E("polls"),className:`p-2 rounded-lg transition-colors ${E("polls")?e==="polls"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-200":"opacity-50 cursor-not-allowed text-gray-400"}`,title:E("polls")?"":"Join a session to participate in polls",children:[d.jsx(ws,{size:20}),d.jsx("span",{className:"sr-only",children:"Polls"})]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>r(!0),className:"p-2 text-gray-600 hover:bg-gray-200 rounded-lg","aria-label":"Minimize overlay",children:d.jsx(Br,{size:20})}),d.jsx("button",{onClick:i,className:"p-2 text-gray-600 hover:bg-gray-200 rounded-lg","aria-label":"Close overlay",children:d.jsx(ks,{size:20})})]})]}),d.jsxs("div",{className:"p-4",children:[d.jsx("div",{role:"tabpanel",id:"ai-panel","aria-labelledby":"ai-tab",className:`transition-opacity duration-300 ${b?"opacity-0":"opacity-100"}`,hidden:e!=="ai",children:e==="ai"&&d.jsx(Wi,{})}),d.jsx("div",{role:"tabpanel",id:"chat-panel","aria-labelledby":"chat-tab",className:`transition-opacity duration-300 ${b?"opacity-0":"opacity-100"}`,hidden:e!=="chat",children:e==="chat"&&E("chat")&&d.jsx(Gi,{})}),d.jsx("div",{role:"tabpanel",id:"anonymous-panel","aria-labelledby":"anonymous-tab",className:`transition-opacity duration-300 ${b?"opacity-0":"opacity-100"}`,hidden:e!=="anonymous",children:e==="anonymous"&&E("anonymous")&&d.jsx(Ki,{})}),d.jsx("div",{role:"tabpanel",id:"polls-panel","aria-labelledby":"polls-tab",className:`transition-opacity duration-300 ${b?"opacity-0":"opacity-100"}`,hidden:e!=="polls",children:e==="polls"&&E("polls")&&d.jsx(Ji,{})})]})]})})})})}function na(e){return e.includes("meet.google.com")?"google-meet":e.includes("zoom.us/j/")?"zoom":e.includes("teams.microsoft.com")?"teams":e.includes("webex.com/meet")?"webex":e.includes("canvas.instructure.com")?"canvas":e.includes("blackboard.com")?"blackboard":e.includes("moodle.org")?"moodle":null}let G=null,es=null;const sa=()=>{document.getElementById("asklynk-floating-overlay-container")||(G=document.createElement("div"),G.id="asklynk-floating-overlay-container",document.body.appendChild(G),G.style.position="fixed",G.style.top="0",G.style.left="0",G.style.width="100%",G.style.height="100%",G.style.zIndex="2147483647",G.style.pointerEvents="none",G.style.visibility="hidden",G.style.opacity="0",G.style.transition="opacity 0.3s ease")},ra=()=>{G&&(es=Zs(G),es.render(d.jsx(Ks.StrictMode,{children:d.jsx(ta,{})})))},qs=()=>{G&&(G.style.pointerEvents="auto",G.style.visibility="visible",G.style.opacity="1")},ia=()=>{G&&(G.style.pointerEvents="none",G.style.visibility="hidden",G.style.opacity="0")};chrome.runtime.onMessage.addListener((e,n,t)=>{e.action==="toggleAssistant"&&((G==null?void 0:G.style.pointerEvents)==="auto"?ia():qs())});sa();ra();const aa=na(window.location.href);console.log("Detected platform:",aa);ke.getState().checkAuth();ee.getState().loadSessions();Cn.getState().setActiveTab(null);document.addEventListener("asklynk-show-dashboard",()=>{Cn.getState().setActiveTab(null),qs()});
